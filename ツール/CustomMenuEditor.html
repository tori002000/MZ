<!DOCTYPE html>
<html lang="ja">
<!--ver 0.2--->

<head>
    <meta charset="UTF-8">
    <title>ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¨ãƒ‡ã‚£ã‚¿</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: #1e1e1e;
            color: #e0e0e0;
            padding: 20px;
            padding-bottom: 90px;
            max-width: 1200px;
        }

        h1 {
            color: #4ec9b0;
            margin-bottom: 20px;
            font-size: 24px;
            border-bottom: 2px solid #4ec9b0;
            padding-bottom: 10px;
        }

        h2 {
            color: #9cdcfe;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .section-title {
            color: #4ec9b0;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 14px;
            font-weight: bold;
            border-bottom: 1px solid #3e3e42;
            padding-bottom: 8px;
        }

        .subsection-title {
            color: #9cdcfe;
            margin-top: 15px;
            margin-bottom: 10px;
            font-size: 12px;
            font-weight: bold;
            padding-left: 10px;
            border-left: 3px solid #4ec9b0;
        }

        .event-details {
            background: #2d2d30;
            margin-bottom: 15px;
            padding: 0;
            border-radius: 4px;
            border-left: 4px solid #4ec9b0;
            overflow: hidden;
        }

        .event-details[open] {
            background: #252526;
        }

        .event-summary {
            color: #9cdcfe;
            padding: 2px 15px;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background-color 0.2s;
        }

        .event-summary:hover {
            background-color: #3e3e42;
        }

        .event-details[open]>.event-summary {
            background-color: #3e3e42;
            border-bottom: 1px solid #3e3e42;
        }

        .event-summary::before {
            content: 'â–¶';
            display: inline-block;
            width: 10px;
            text-align: center;
            transition: transform 0.2s;
            color: #4ec9b0;
        }

        .event-details[open]>.event-summary::before {
            transform: rotate(90deg);
        }

        .event-details>div {
            padding: 15px;
        }

        .event-details .form-row:last-child {
            margin-bottom: 0;
        }

        .section {
            background: #252526;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #4ec9b0;
            border-radius: 4px;
        }

        .form-group {
            margin-bottom: 5px;
            padding: 5px;
            background: #2d2d30;
            border-radius: 4px;
        }

        .form-label {
            color: #ce9178;
            font-weight: bold;
            font-size: 12px;
            cursor: help;
            border-bottom: 1px dotted #4ec9b0;
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .form-label:hover {
            color: #9cdcfe;
        }

        .tooltip-icon {
            display: inline-block;
            width: 14px;
            height: 14px;
            background: #4ec9b0;
            color: #1e1e1e;
            border-radius: 50%;
            text-align: center;
            font-size: 10px;
            line-height: 14px;
            font-weight: bold;
            cursor: help;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            background-color: #4a4a50;
            color: #d4d4d4;
            text-align: left;
            border-radius: 4px;
            padding: 8px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 0;
            width: 250px;
            font-size: 11px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            border: 1px solid #4ec9b0;
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 10px;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #4a4a50 transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 6px;
            background: #1e1e1e;
            color: #d4d4d4;
            border: 1px solid #3e3e42;
            border-radius: 3px;
            font-size: 13px;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #4ec9b0;
            box-shadow: 0 0 5px rgba(78, 201, 176, 0.3);
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            position: sticky;
            bottom: 0;
            padding: 15px 12px;
            background: #252526;
            border-top: 1px solid #3e3e42;
            border-radius: 4px;
            z-index: 100;
            margin-top: 20px;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 13px;
            transition: all 0.2s;
        }

        .btn-save {
            background: #4ec9b0;
            color: #1e1e1e;
        }

        .btn-save:hover {
            background: #5edcc9;
        }

        .btn-save:active {
            background: #42a99c;
        }

        .btn-cancel {
            background: #6a6a6e;
            color: #d4d4d4;
        }

        .btn-cancel:hover {
            background: #7a7a7e;
        }

        .window-item {
            padding: 12px 15px;
            background: #2d2d30;
            border: 1px solid #3e3e42;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .window-item:hover {
            background: #3e3e42;
        }

        .window-id {
            color: #4ec9b0;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .status-online {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #4ec9b0;
            margin-right: 8px;
        }

        .status-text {
            color: #4ec9b0;
            font-size: 12px;
        }

        .no-data {
            color: #858585;
            font-style: italic;
            padding: 20px;
            text-align: center;
        }

        .form-section {
            background: #2d2d30;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            margin-bottom: 5px;
        }

        .form-row.full {
            grid-template-columns: 1fr;
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            background: #4ec9b0;
            color: #1e1e1e;
            border-radius: 4px;
            display: none;
            z-index: 3000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            font-weight: bold;
            min-width: 300px;
            text-align: center;
            white-space: pre-wrap;
        }

        .notification.show {
            display: block;
        }

        #windowEditorContainer {
            padding-bottom: 70px;
        }

        .window-button-group {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            padding: 15px 20px;
            background: #252526;
            border-top: 1px solid #3e3e42;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
        }

        .button-event-container {
            background: #252526;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #4ec9b0;
            border-radius: 4px;
        }

        .button-event-toolbar {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }

        .button-event-table {
            width: 100%;
            border-collapse: collapse;
            background: #1e1e1e;
            border-radius: 4px;
            overflow: hidden;
            display: none;
        }

        .button-event-table[data-visible="true"] {
            display: table;
        }

        .button-event-table thead {
            background: #2d2d30;
        }

        .button-event-table th {
            padding: 12px 15px;
            text-align: left;
            color: #9cdcfe;
            font-weight: bold;
            border-bottom: 1px solid #3e3e42;
        }

        .button-event-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #3e3e42;
            color: #e0e0e0;
        }

        .button-event-table tbody tr:hover {
            background: #2d2d30;
        }

        .button-event-table .action-buttons {
            display: flex;
            gap: 8px;
        }

        .button-event-table .action-buttons button {
            padding: 6px 12px;
            font-size: 12px;
            min-width: auto;
        }

        .btn-primary {
            background: #0e639c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .btn-primary:hover {
            background: #1177bb;
        }

        .btn-edit {
            background: #4ec9b0;
            color: #1e1e1e;
        }

        .btn-edit:hover {
            background: #5dd9c1;
        }

        .btn-delete {
            background: #d16969;
            color: white;
        }

        .btn-delete:hover {
            background: #e07a7a;
        }

        /* ButtonEventãƒ¢ãƒ¼ãƒ€ãƒ« */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            overflow: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: #252526;
            border: 1px solid #3e3e42;
            border-radius: 8px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.8);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #3e3e42;
            padding-bottom: 15px;
        }

        .modal-header h2 {
            margin: 0;
            color: #9cdcfe;
        }

        .modal-close {
            background: none;
            border: none;
            color: #9cdcfe;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: #4ec9b0;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            border-top: 1px solid #3e3e42;
            padding-top: 15px;
        }
    </style>
</head>

<body>
    <h1>ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç·¨é›†ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦</h1>

    <div class="section">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span class="status-text"><span class="status-online"></span>ã‚²ãƒ¼ãƒ æ¥ç¶šä¸­</span>
        </div>
    </div>

    <div id="notification" class="notification"></div>

    <div id="editorContainer" style="display: none;">
        <div class="section">
            <h2>ğŸ“‹ ã‚·ãƒ¼ãƒ³æƒ…å ±ç·¨é›†</h2>

            <div class="form-section">
                <div class="form-group">
                    <label class="form-label tooltip">
                        ã‚·ãƒ¼ãƒ³è­˜åˆ¥å­
                        <span class="tooltiptext">ã‚·ãƒ¼ãƒ³ã‚’å‘¼ã³å‡ºã™éš›ã®è­˜åˆ¥å­ã§ã™ã€‚ä»–ã®è­˜åˆ¥å­ã¨é‡è¤‡ã—ãªã„æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚</span>
                    </label>
                    <input type="text" id="sceneId" class="form-input" placeholder="ä¾‹ï¼šScene_CustomMenu">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒ˜ãƒ«ãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½¿ç”¨
                            <span class="tooltiptext">ãƒ˜ãƒ«ãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¡¨ç¤ºæ–¹å¼ã‚’è¨­å®šã—ã¾ã™ã€‚</span>
                        </label>
                        <select id="useHelp" class="form-select">
                            <option value="0">ä½¿ç”¨ã—ãªã„</option>
                            <option value="1">ç”»é¢ä¸‹éƒ¨ã«è¡¨ç¤º(MZãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)</option>
                            <option value="2">ç”»é¢ä¸Šéƒ¨ã«è¡¨ç¤º</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <div class="form-label-wrapper">
                            <span class="form-label tooltip">
                                ãƒ˜ãƒ«ãƒ—è¡Œæ•°
                                <span class="tooltiptext">ãƒ˜ãƒ«ãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¡Œæ•°ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®2ã‹ã‚‰å¤‰æ›´ã—ãŸã„å ´åˆã«æŒ‡å®šã—ã¾ã™ã€‚0ã§è‡ªå‹•ã€‚</span>
                            </span>
                        </div>
                        <input type="number" id="helpRows" class="form-input" min="0" placeholder="0: è‡ªå‹•">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <div class="form-label-wrapper">
                            <span class="form-label tooltip">
                                ãƒ”ã‚¯ãƒãƒ£è¡¨ç¤ºå„ªå…ˆåº¦
                                <span class="tooltiptext">ãƒ”ã‚¯ãƒãƒ£ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å¯¾ã™ã‚‹è¡¨ç¤ºå„ªå…ˆåº¦ã‚’è¨­å®šã—ã¾ã™ã€‚</span>
                            </span>
                        </div>
                        <select id="picturePriority" class="form-select">
                            <option value="0">æœ€å‰é¢</option>
                            <option value="1">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸‹</option>
                            <option value="2">ã™ã¹ã¦ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸‹</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            ä¸¦åˆ—ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆID
                            <span class="tooltiptext">ã‚·ãƒ¼ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹é–“ã€å¸¸ã«å®Ÿè¡Œã•ã‚Œç¶šã‘ã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ³¨æ„ã€‚</span>
                        </label>
                        <input type="number" id="parallelEventId" class="form-input" min="0" placeholder="0: ãªã—">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒšãƒ¼ã‚¸ãƒœã‚¿ãƒ³ä½¿ç”¨
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã—ãŸå ´åˆã€ãƒšãƒ¼ã‚¸ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="usePageButtons" style="width: auto;">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            èƒŒæ™¯ã¼ã‹ã—ç„¡åŠ¹åŒ–
                            <span class="tooltiptext">èƒŒæ™¯ã‚¹ãƒŠãƒƒãƒ—ã®ã¼ã‹ã—ãŒé©ç”¨ã•ã‚Œãªããªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="snapNoFilter" style="width: auto;">
                    </div>
                </div>
                <div class="form-group">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                            åˆæœŸã‚¤ãƒ™ãƒ³ãƒˆ
                            <span class="tooltiptext">ã‚·ãƒ¼ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸç¬é–“ã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚åˆæœŸã‚¤ãƒ™ãƒ³ãƒˆã«æŒ‡å®šã—ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã¨ç”»é¢ã‹ã‚‰æŠœã‘ã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="sceneInitialEventEnabled"
                            onchange="toggleSection('sceneInitialEventEnabled', 'sceneInitialEventDetails')">
                    </div>
                    <details class="event-details" id="sceneInitialEventDetails">
                        <summary class="event-summary"></summary>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                                    <span class="tooltiptext">ã‚·ãƒ¼ãƒ³ãŒè¡¨ç¤ºã•ã‚ŒãŸç¬é–“ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="sceneInitialCommandId" class="form-input" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ID
                                    <span class="tooltiptext">åˆæœŸã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã§ã™ã€‚</span>
                                </label>
                                <select id="sceneInitialFocusWindowId" class="form-select">
                                    <option value="">(æŒ‡å®šãªã—)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                                    <span class="tooltiptext">åˆæœŸã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§ã™ã€‚-1ã§æ“ä½œã—ã¾ã›ã‚“ã€‚</span>
                                </label>
                                <input type="number" id="sceneInitialFocusWindowIndex" class="form-input" min="-1"
                                    value="-1">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¤ãƒƒãƒ
                                    <span class="tooltiptext">åˆæœŸã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«ONã«ãªã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="sceneInitialSwitchId" class="form-input" min="0">
                            </div>
                        </div>
                        <div class="form-row full">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                                    <span class="tooltiptext">åˆæœŸã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                                </label>
                                <textarea id="sceneInitialScript" class="form-input" style="height: 60px;"
                                    placeholder="ä¾‹: console.log('Scene Start');"></textarea>
                                <div class="form-row">
                                    <div class="form-group" style="flex: 1;">
                                        <select id="sceneInitialScriptTemplate" class="form-select"></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    å…ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é¸æŠè§£é™¤
                                    <span class="tooltiptext">åˆæœŸã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œæ™‚ã«å…ƒã€…ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã¦ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤ã—ã¾ã™ã€‚</span>
                                </label>
                                <input type="checkbox" id="sceneInitialDeselect" style="width: auto;">
                            </div>
                        </div>
                    </details>
                </div>
                <div class="form-group">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                            ã‚¢ã‚¯ã‚¿ãƒ¼å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆ
                            <span class="tooltiptext">ã‚¢ã‚¯ã‚¿ãƒ¼ã‚’å¤‰æ›´ã—ãŸç¬é–“ã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã§ã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã¯å¤‰æ›´ã•ã‚Œã¾ã›ã‚“ã€‚</span>
                        </label>
                        <input type="checkbox" id="sceneActorChangeEventEnabled"
                            onchange="toggleSection('sceneActorChangeEventEnabled', 'sceneActorChangeEventDetails')">
                    </div>
                    <details class="event-details" id="sceneActorChangeEventDetails">
                        <summary class="event-summary"></summary>
                        <div class="form-row" id="sceneActorChangeEvent">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                                    <span class="tooltiptext">ã‚¢ã‚¯ã‚¿ãƒ¼ã‚’å¤‰æ›´ã—ãŸç¬é–“ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="sceneActorChangeCommandId" class="form-input" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ID
                                    <span class="tooltiptext">ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã§ã™ã€‚</span>
                                </label>
                                <select id="sceneActorChangeFocusWindowId" class="form-select">
                                    <option value="">(æŒ‡å®šãªã—)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                                    <span class="tooltiptext">ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§ã™ã€‚-1ã§æ“ä½œã—ã¾ã›ã‚“ã€‚</span>
                                </label>
                                <input type="number" id="sceneActorChangeFocusWindowIndex" class="form-input" min="-1"
                                    value="-1">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¤ãƒƒãƒ
                                    <span class="tooltiptext">ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«ONã«ãªã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="sceneActorChangeSwitchId" class="form-input" min="0">
                            </div>
                        </div>
                        <div class="form-row full">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                                    <span class="tooltiptext">ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                                </label>
                                <textarea id="sceneActorChangeScript" class="form-input" style="height: 60px;"
                                    placeholder="ä¾‹: console.log('Actor Changed');"></textarea>
                                <div class="form-row">
                                    <div class="form-group" style="flex: 1;">
                                        <select id="sceneActorChangeScriptTemplate" class="form-select"></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    å…ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é¸æŠè§£é™¤
                                    <span class="tooltiptext">ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œæ™‚ã«å…ƒã€…ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã¦ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤ã—ã¾ã™ã€‚</span>
                                </label>
                                <input type="checkbox" id="sceneActorChangeDeselect" style="width: auto;">
                            </div>
                        </div>
                    </details>
                </div>
                <div class="form-group">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                            ãƒ‘ãƒãƒ©ãƒèƒŒæ™¯
                            <span class="tooltiptext">ã‚·ãƒ¼ãƒ³ã®èƒŒæ™¯ç”»åƒè¨­å®šã§ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="scenePanoramaEnabled"
                            onchange="toggleSection('scenePanoramaEnabled', 'scenePanoramaDetails')">
                    </div>
                    <details class="event-details" id="scenePanoramaDetails">
                        <summary class="event-summary"></summary>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«
                                    <span class="tooltiptext">img/parallaxes/ å†…ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆæ‹¡å¼µå­ãªã—ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚</span>
                                </label>
                                <input type="text" id="scenePanoramaImage" class="form-input" placeholder="BlueSky">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«X
                                    <span class="tooltiptext">æ¨ªæ–¹å‘ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é€Ÿåº¦ã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="scenePanoramaScrollX" class="form-input" value="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«Y
                                    <span class="tooltiptext">ç¸¦æ–¹å‘ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é€Ÿåº¦ã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="scenePanoramaScrollY" class="form-input" value="0">
                            </div>
                        </div>
                    </details>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-cancel" onclick="discardChanges()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="btn btn-save" onclick="saveChanges()">å¤‰æ›´ã‚’ä¿å­˜</button>
            </div>
        </div>

        <div class="section">
            <h2>ğŸªŸ ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç·¨é›†</h2>

            <div style="margin-bottom: 15px;">
                <select id="windowSelector" class="form-select" onchange="selectWindow()">
                    <option value="">-- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é¸æŠ --</option>
                </select>
            </div>

            <div style="margin-bottom: 15px; display: flex; gap: 10px;">
                <button class="btn btn-primary" onclick="addWindow()">+ ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿½åŠ </button>
                <button class="btn btn-edit" onclick="openWizard()">ğŸª„ ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã§è¿½åŠ </button>
                <button class="btn btn-danger" onclick="deleteWindow()">å‰Šé™¤</button>
            </div>
            <div id="windowEditorContainer" style="display: none;" class="form-section">
                <div class="form-group">
                    <label class="form-label tooltip">
                        ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­
                        <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è­˜åˆ¥å­(ID)ã§ã™ã€‚ãƒªã‚¹ãƒˆå†…ã§ä»–ã®è­˜åˆ¥å­ã¨é‡è¤‡ã—ãªã„æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚</span>
                    </label>
                    <input type="text" id="windowId" class="form-input">
                </div>

                <h3 style="color: #9cdcfe; margin-top: 15px; margin-bottom: 10px; font-size: 13px; font-weight: bold;">
                    ğŸ“ åº§æ¨™ãƒ»ã‚µã‚¤ã‚º</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            Xåº§æ¨™
                            <span class="tooltiptext">Xåº§æ¨™ã§ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowX" class="form-input" min="-2000">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            Yåº§æ¨™
                            <span class="tooltiptext">Yåº§æ¨™ã§ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowY" class="form-input" min="-2000">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ç›¸å¯¾Xåº§æ¨™ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
                            <span class="tooltiptext">æŒ‡å®šã—ãŸå ´åˆã€Xåº§æ¨™ãŒå¯¾è±¡ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‹ã‚‰ã®ç›¸å¯¾ä½ç½®ã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <select id="windowRelativeWindowIdX" class="form-select">
                            <option value="">-- ãªã— --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            ç›¸å¯¾Yåº§æ¨™ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦
                            <span class="tooltiptext">æŒ‡å®šã—ãŸå ´åˆã€Yåº§æ¨™ãŒå¯¾è±¡ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‹ã‚‰ã®ç›¸å¯¾ä½ç½®ã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <select id="windowRelativeWindowIdY" class="form-select">
                            <option value="">-- ãªã— --</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            æ¨ªå¹…
                            <span class="tooltiptext">æ¨ªå¹…ã§ã™ã€‚0ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ç”»é¢ã®æ¨ªå¹…ã«åˆã‚ã›ã‚‰ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowWidth" class="form-input" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            é«˜ã•
                            <span class="tooltiptext">é«˜ã•ã§ã™ã€‚0ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ã€è¡Œæ•°ã€ã®æŒ‡å®šã‚’ã‚‚ã¨ã«è‡ªå‹•è¨­å®šã•ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowHeight" class="form-input" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            åˆ—æ•°
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆ—æ•°ã§ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowColumns" class="form-input" min="1">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            è¡Œæ•°
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¡Œæ•°ã§ã™ã€‚é«˜ã•ã‚’æ±ºå®šã™ã‚‹ãŸã‚ã«ä½¿ã‚ã‚Œã¾ã™ã€‚0ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ã‚³ãƒãƒ³ãƒ‰æ•°ã‚’ã‚‚ã¨ã«è‡ªå‹•è¨­å®šã•ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowRows" class="form-input" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            Xè»¸åŸç‚¹
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åº§æ¨™ã‚’æ±ºã‚ã‚‹åŸç‚¹ã§ã™ã€‚æŒ‡å®šã™ã‚‹å ´åˆã€æ¨ªå¹…ã‚‚æŒ‡å®šã—ã¦ãã ã•ã„ã€‚</span>
                        </label>
                        <select id="windowOriginX" class="form-select">
                            <option value="0">å·¦</option>
                            <option value="1">ä¸­å¤®</option>
                            <option value="2">å³</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            å›è»¢è§’åº¦
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è§’åº¦ã§ã™ã€‚åº¦æ•°æ³•(0-360)ã§æŒ‡å®šã—ã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowRotation" class="form-input" min="0" max="360">
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            é …ç›®ã®é«˜ã•
                            <span class="tooltiptext">1é …ç›®ã‚ãŸã‚Šã®é«˜ã•ã§ã™ã€‚0ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowItemHeight" class="form-input" min="0">
                    </div>
                </div>

                <h3 style="color: #9cdcfe; margin-top: 15px; margin-bottom: 10px; font-size: 13px; font-weight: bold;">
                    ğŸ¨ è¡¨ç¤ºãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º
                            <span class="tooltiptext">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã§ã™ã€‚0ã‚’æŒ‡å®šã™ã‚‹ã¨ä»–ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¨åŒã˜ã‚µã‚¤ã‚ºã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowFontSize" class="form-input" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒ•ã‚©ãƒ³ãƒˆ
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’å¤‰æ›´ã—ã¾ã™ã€‚ãƒ•ã‚©ãƒ³ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã¯æä¾›ã—ãªã„ã®ã§åˆ¥é€”ç”¨æ„ã—ã¦ãã ã•ã„ã€‚</span>
                        </label>
                        <input type="text" id="windowFontFace" class="form-input" placeholder="(ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ¼
                            <span class="tooltiptext">æç”»æ–‡å­—åˆ—ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚«ãƒ©ãƒ¼ã§ã™ã€‚åˆ¶å¾¡æ–‡å­—ã€Œ\c[n]ã€ã§æŒ‡å®šã™ã‚‹è‰²ç•ªå·ã‚’æŒ‡å®šã—ã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowTextColor" class="form-input" min="0" max="31">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            é …ç›®èƒŒæ™¯ã‚’è¡¨ç¤ºã—ãªã„
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€é …ç›®ã®é»’ã„èƒŒæ™¯ãŒè¡¨ç¤ºã•ã‚Œãªããªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowNoItemBackground" style="width: auto;">
                    </div>
                </div>

                <h3 style="color: #9cdcfe; margin-top: 15px; margin-bottom: 10px; font-size: 13px; font-weight: bold;">
                    âš™ï¸ å‹•ä½œãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowCancelable" style="width: auto;">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚·ãƒ¼ãƒ³æˆ»ã—ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨ã“ã‚ŒãŒæœ€åˆã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã‚ã‚‹å ´åˆã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ™‚ã«å‰ã®ã‚·ãƒ¼ãƒ³ã«æˆ»ã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowPopCancel" style="width: auto;">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚¢ã‚¯ã‚¿ãƒ¼å¤‰æ›´å¯èƒ½
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨PageUp, PageDownã§ã‚¢ã‚¯ã‚¿ãƒ¼ãƒã‚§ãƒ³ã‚¸ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowActorChangeable" style="width: auto;">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            é–‹é–‰ã‚¢ãƒ‹ãƒ¡è¡¨ç¤º
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é–‹é–‰ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowShowOpenAnimation" style="width: auto;">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚«ãƒ¼ã‚½ãƒ«ã‚’æ‰‹å‰ã«è¡¨ç¤º
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚«ãƒ¼ã‚½ãƒ«ãŒé …ç›®ã®ä¸Šã«è¢«ã›ã‚‹ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowCursorOverContents" style="width: auto;">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            æ ã‚’è¡¨ç¤ºã—ãªã„
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®æ ãŒè¡¨ç¤ºã•ã‚Œãªããªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowNoFrame" style="width: auto;">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            éãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã¯éš ã™
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒå½“ãŸã£ã¦ã„ãªã„ã¨ãã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒéè¡¨ç¤ºã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowHiddenNoFocus" style="width: auto;">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            éãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã¯æš—è»¢
                            <span class="tooltiptext">æœ‰åŠ¹ã«ã™ã‚‹ã¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒå½“ãŸã£ã¦ã„ãªã„ã¨ãã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸­èº«ãŒæš—ããªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowDarkNoFocus" style="width: auto;">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ä»–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«é‡ã­ã‚‹
                            <span class="tooltiptext">ä»–ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¨é‡ãªã£ã¦è¡¨ç¤ºã•ã›ãŸã¨ãã«èƒŒå¾Œã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ãƒã‚¹ã‚­ãƒ³ã‚°ã•ã›ãªããªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowOverlapOther" style="width: auto;">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <div style="display: flex; align-items: center; margin-bottom: 6px;">
                            <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                                æ±ºå®šSE
                                <span class="tooltiptext">é¸æŠã™ã‚‹ã¨é€šå¸¸ã®æ±ºå®šéŸ³ã®ä»£ã‚ã‚Šã«æŒ‡å®šã—ãŸSEãŒæ¼”å¥ã•ã‚Œã¾ã™ã€‚</span>
                            </label>
                            <input type="checkbox" id="windowOkSoundEnabled"
                                onchange="toggleSection('windowOkSoundEnabled', 'windowOkSoundContainer')">
                        </div>
                        <div id="windowOkSoundContainer" style="margin-top: 6px;">
                            <div style="margin-bottom: 8px;">
                                <label style="font-size: 12px;">ãƒ•ã‚¡ã‚¤ãƒ«å:</label>
                                <input type="text" id="windowOkSoundName" class="form-input" placeholder="ä¾‹: Cursor1">
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <div style="flex: 1;">
                                    <label style="font-size: 12px;">éŸ³é‡:</label>
                                    <input type="number" id="windowOkSoundVolume" class="form-input" min="0" max="100"
                                        value="90">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 12px;">ãƒ”ãƒƒãƒ:</label>
                                    <input type="number" id="windowOkSoundPitch" class="form-input" min="50" max="150"
                                        value="100">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 12px;">ä½ç›¸:</label>
                                    <input type="number" id="windowOkSoundPan" class="form-input" min="-100" max="100"
                                        value="0">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <h3 style="color: #9cdcfe; margin-top: 15px; margin-bottom: 10px; font-size: 13px; font-weight: bold;">
                    ğŸ“‹ ãƒ‡ãƒ¼ã‚¿ãƒ»å¤‰æ•°</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            è¡¨ç¤ºã‚¹ã‚¤ãƒƒãƒID
                            <span class="tooltiptext">æŒ‡å®šã—ãŸã‚¹ã‚¤ãƒƒãƒãŒONã®å ´åˆã®ã¿ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowVisibleSwitchId" class="form-input" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            å†æç”»ã‚¹ã‚¤ãƒƒãƒ
                            <span class="tooltiptext">æŒ‡å®šã—ãŸã‚¹ã‚¤ãƒƒãƒãŒONã«ãªã‚‹ã¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒå†æç”»ã•ã‚Œã¾ã™ã€‚å†æç”»ã®å¾Œã€ã‚¹ã‚¤ãƒƒãƒã¯è‡ªå‹•ã§OFFã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowRefreshSwitchId" class="form-input" min="0">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ ¼ç´å¤‰æ•°
                            <span class="tooltiptext">ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå¸¸ã«æ ¼ç´ã•ã‚Œã‚‹å¤‰æ•°ã§ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowIndexVariableId" class="form-input" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¨˜æ†¶
                            <span class="tooltiptext">ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ ¼ç´å¤‰æ•°ã‚’æŒ‡å®šã—ã¦ã„ã‚‹å ´åˆã€ç”»é¢ã‚’é–‹ã„ãŸã¨ãã«ã‚«ãƒ¼ã‚½ãƒ«ã®åˆæœŸå€¤ã‚’å¤‰æ•°å€¤ã§å¾©å…ƒã—ã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="windowRememberIndex" style="width: auto;">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            é¸æŠé …ç›®æ ¼ç´å¤‰æ•°
                            <span class="tooltiptext">é¸æŠä¸­ã®é …ç›®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒå¸¸ã«æ ¼ç´ã•ã‚Œã‚‹å¤‰æ•°ã§ã™ã€‚æ•°å€¤ä»¥å¤–ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ ¼ç´ã•ã‚Œã‚‹ã®ã§å–ã‚Šæ‰±ã„ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</span>
                        </label>
                        <input type="number" id="windowItemVariableId" class="form-input" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            å…¨é¸æŠã‚¹ã‚¤ãƒƒãƒID
                            <span class="tooltiptext">æŒ‡å®šã—ãŸã‚¹ã‚¤ãƒƒãƒãŒONã®ã¨ãã‚«ãƒ¼ã‚½ãƒ«ãŒå…¨é¸æŠçŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="windowCursorAllSwitchId" class="form-input" min="0">
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒã‚¹ã‚­ãƒ³ã‚°ãƒ†ã‚­ã‚¹ãƒˆ
                            <span class="tooltiptext">ã‚³ãƒãƒ³ãƒ‰ãŒéè¡¨ç¤ºã«ã•ã‚ŒãŸã¨ãã€æ¶ˆãˆã‚‹ä»£ã‚ã‚Šã«æŒ‡å®šæ–‡å­—åˆ—ã§ãƒã‚¹ã‚­ãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <input type="text" id="windowMaskingText" class="form-input" placeholder="(ãªã—)">
                    </div>
                </div>

                <h3 class="section-title">ï¿½ ã‚³ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆ</h3>
                <div class="button-event-container">
                    <div class="button-event-toolbar">
                        <button class="btn btn-primary" onclick="addCommandList()">+ ã‚³ãƒãƒ³ãƒ‰è¿½åŠ </button>
                    </div>
                    <table id="commandListTable" class="button-event-table">
                        <thead>
                            <tr>
                                <th>ãƒ†ã‚­ã‚¹ãƒˆ</th>
                                <th>ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆ</th>
                                <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                            </tr>
                        </thead>
                        <tbody id="commandListItems">
                            <!-- ã‚³ãƒãƒ³ãƒ‰é …ç›®ãŒã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ -->
                        </tbody>
                    </table>
                    <p id="noCommandListItems" class="no-data">ã‚³ãƒãƒ³ãƒ‰ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
                </div>

                <h3 class="section-title">ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ä¸€è¦§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­
                            <span class="tooltiptext">åˆ¥ã®ä¸€è¦§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®å ´åˆã€å‚ç…§ã™ã‚‹ä¸€è¦§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è­˜åˆ¥å­ã‚’æŒ‡å®šã—ã¾ã™ã€‚</span>
                        </label>
                        <select id="windowListWindowId" class="form-select">
                            <option value="">(ãªã—)</option>
                        </select>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ä¸€è¦§å–å¾—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">é …ç›®ã®ä¸€è¦§ã‚’è¿”ã™ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰é¸ã¶ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã€ä¸€è¦§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã€ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ç„¡åŠ¹ã§ã™ã€‚</span>
                        </label>
                        <textarea id="windowListScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: $gameParty.members(); // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¡ãƒ³ãƒãƒ¼"></textarea>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <select id="listScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒ•ã‚£ãƒ«ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç‰¹å®šã®é …ç›®ã‚’é™¤å¤–ã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                        </label>
                        <textarea id="windowFilterScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: item.meta['value']; // ãƒ¡ãƒ¢æ¬„ã«<value>ãŒã‚ã‚‹é …ç›®ã®ã¿"></textarea>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <select id="filterScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒãƒƒãƒ”ãƒ³ã‚°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">é …ç›®ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ã—ã¦åˆ¥ã®å€¤ã«ç½®ãæ›ãˆã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                        </label>
                        <textarea id="windowMappingScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: $dataSystem.equipTypes[item]; // ã‚¹ãƒ­ãƒƒãƒˆIDã‚’è£…å‚™ã‚¿ã‚¤ãƒ—åã«å¤‰æ›"></textarea>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <select id="mappingScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚½ãƒ¼ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«è¡¨ç¤ºã™ã‚‹é …ç›®ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                        </label>
                        <textarea id="windowSortScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: (a, b) => a.id - b.id; // IDé †"></textarea>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <select id="sortScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            è¤‡æ•°è¡Œæç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">è¤‡æ•°è¡Œã§é …ç›®ã‚’æç”»ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚æ”¹è¡Œã‚’å«ã‚ã¦è¨˜è¿°ã§ãã¾ã™ã€‚</span>
                        </label>
                        <textarea id="windowItemDrawMultiLineScript" class="form-input" style="height: 80px;"
                            placeholder="ä¾‹: this.drawActorName(item, r.x, r.y);\nthis.drawActorLevel(item, r.x, r.y+30);"></textarea>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <select id="itemDrawMultiLineScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 15px; margin-bottom: 15px;">
                    <label class="form-label tooltip">
                        é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                        <span class="tooltiptext">é …ç›®ã‚’æç”»ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚å¤‰æ•°[item]ã‹ã‚‰å„è¦ç´ ãŒå‚ç…§ã§ãã¾ã™ã€‚çœç•¥ã™ã‚‹ã¨è‡ªåƒã§æç”»ã•ã‚Œã¾ã™ã€‚</span>
                    </label>
                    <div class="button-event-container">
                        <div class="button-event-toolbar">
                            <button class="btn btn-primary" onclick="addItemDrawScript()">+ é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ </button>
                        </div>
                        <table id="itemDrawScriptTable" class="button-event-table">
                            <thead>
                                <tr>
                                    <th>ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</th>
                                    <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                                </tr>
                            </thead>
                            <tbody id="itemDrawScriptList">
                                <!-- é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ -->
                            </tbody>
                        </table>
                        <p id="noItemDrawScripts" class="no-data">é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            é¸æŠå¯èƒ½åˆ¤å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">é …ç›®ãŒé¸æŠå¯èƒ½ã‹ã‚’åˆ¤å®šã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚trueã§é¸æŠå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <textarea id="windowIsEnableScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: item.meta['value']; // ãƒ¡ãƒ¢æ¬„ã«<value>ãŒã‚ã‚‹é …ç›®ã®ã¿é¸æŠå¯èƒ½"></textarea>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <select id="isEnableScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            å…±é€šãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆ
                            <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã§ä½•ã‚‚é¸æŠã•ã‚Œã¦ã„ãªã„æ™‚ã‚„ã€å…±é€šã§è¡¨ç¤ºã™ã‚‹ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆã§ã™ã€‚</span>
                        </label>
                        <textarea id="windowCommonHelpText" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: é …ç›®ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"></textarea>
                    </div>
                </div>

                <h3 class="section-title">ğŸ¬ ã‚¤ãƒ™ãƒ³ãƒˆ</h3>

                <div class="form-group">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                            æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆ
                            <span class="tooltiptext">é …ç›®ãŒæ±ºå®šã•ã‚ŒãŸç¬é–“ã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="decisionEventEnabled"
                            onchange="toggleSection('decisionEventEnabled', 'decisionEventDetails')">
                    </div>
                    <details class="event-details" id="decisionEventDetails">
                        <summary class="event-summary"></summary>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                                    <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã§é …ç›®ã‚’é¸æŠã—ã¦æ±ºå®šã—ãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="decisionCommandId" class="form-input" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ID
                                    <span class="tooltiptext">æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã§ã™ã€‚</span>
                                </label>
                                <select id="decisionFocusWindowId" class="form-select">
                                    <option value="">(æŒ‡å®šãªã—)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                                    <span class="tooltiptext">æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§ã™ã€‚-1ã§æ“ä½œã—ã¾ã›ã‚“ã€‚</span>
                                </label>
                                <input type="number" id="decisionFocusWindowIndex" class="form-input" min="-1"
                                    value="-1">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¤ãƒƒãƒ
                                    <span class="tooltiptext">æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«ONã«ãªã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="decisionSwitchId" class="form-input" min="0">
                            </div>
                        </div>
                        <div class="form-row full">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                                    <span class="tooltiptext">æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                                </label>
                                <textarea id="decisionScript" class="form-input" style="height: 60px;"
                                    placeholder="ä¾‹: SceneManager.callCustomMenu('Scene_Menu');"></textarea>

                                <div class="form-row">
                                    <div class="form-group" style="flex: 1;">
                                        <select id="decisionScriptTemplate" class="form-select"></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    å…ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é¸æŠè§£é™¤
                                    <span class="tooltiptext">æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œæ™‚ã«å…ƒã€…ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã¦ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤ã—ã¾ã™ã€‚</span>
                                </label>
                                <input type="checkbox" id="decisionDeselect" style="width: auto;">
                            </div>
                        </div>
                    </details>
                </div>

                <div class="form-group">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ
                            <span class="tooltiptext">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚ŒãŸç¬é–“ã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="cancelEventEnabled"
                            onchange="toggleSection('cancelEventEnabled', 'cancelEventDetails')">
                    </div>
                    <details class="event-details" id="cancelEventDetails">
                        <summary class="event-summary"></summary>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                                    <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="cancelCommandId" class="form-input" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ID
                                    <span class="tooltiptext">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã§ã™ã€‚</span>
                                </label>
                                <select id="cancelFocusWindowId" class="form-select">
                                    <option value="">(æŒ‡å®šãªã—)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                                    <span class="tooltiptext">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§ã™ã€‚-1ã§æ“ä½œã—ã¾ã›ã‚“ã€‚</span>
                                </label>
                                <input type="number" id="cancelFocusWindowIndex" class="form-input" min="-1" value="-1">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¤ãƒƒãƒ
                                    <span class="tooltiptext">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«ONã«ãªã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="cancelSwitchId" class="form-input" min="0">
                            </div>
                        </div>
                        <div class="form-row full">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                                    <span class="tooltiptext">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                                </label>
                                <textarea id="cancelScript" class="form-input" style="height: 60px;"
                                    placeholder="ä¾‹: this.popScene();"></textarea>
                                <div class="form-row">
                                    <div class="form-group" style="flex: 1;">
                                        <select id="cancelScriptTemplate" class="form-select"></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    å…ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é¸æŠè§£é™¤
                                    <span class="tooltiptext">ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œæ™‚ã«å…ƒã€…ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã¦ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤ã—ã¾ã™ã€‚</span>
                                </label>
                                <input type="checkbox" id="cancelDeselect" style="width: auto;">
                            </div>
                        </div>
                    </details>
                </div>

                <div class="form-group">
                    <div style="display: flex; align-items: center; margin-bottom: 5px;">
                        <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                            ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ
                            <span class="tooltiptext">ã‚«ãƒ¼ã‚½ãƒ«ãŒå‹•ã„ãŸç¬é–“ã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="cursorEventEnabled"
                            onchange="toggleSection('cursorEventEnabled', 'cursorEventDetails')">
                    </div>
                    <details class="event-details" id="cursorEventDetails">
                        <summary class="event-summary"></summary>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                                    <span class="tooltiptext">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã§ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã—ãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="cursorCommandId" class="form-input" min="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ID
                                    <span class="tooltiptext">ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã§ã™ã€‚</span>
                                </label>
                                <select id="cursorFocusWindowId" class="form-select">
                                    <option value="">(æŒ‡å®šãªã—)</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                                    <span class="tooltiptext">ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§ã™ã€‚-1ã§æ“ä½œã—ã¾ã›ã‚“ã€‚</span>
                                </label>
                                <input type="number" id="cursorFocusWindowIndex" class="form-input" min="-1" value="-1">
                            </div>

                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¤ãƒƒãƒ
                                    <span class="tooltiptext">ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«ONã«ãªã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚</span>
                                </label>
                                <input type="number" id="cursorSwitchId" class="form-input" min="0">
                            </div>
                        </div>
                        <div class="form-row full">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                                    <span class="tooltiptext">ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                                </label>
                                <textarea id="cursorScript" class="form-input" style="height: 60px;"
                                    placeholder="ä¾‹: console.log('ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•'); "></textarea>
                                <div class="form-row">
                                    <div class="form-group" style="flex: 1;">
                                        <select id="cursorScriptTemplate" class="form-select"></select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label tooltip">
                                    å…ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é¸æŠè§£é™¤
                                    <span class="tooltiptext">ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œæ™‚ã«å…ƒã€…ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã¦ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤ã—ã¾ã™ã€‚</span>
                                </label>
                                <input type="checkbox" id="cursorDeselect" style="width: auto;">
                            </div>
                        </div>
                    </details>
                </div>

                <h3 class="section-title">ğŸ”˜ ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ</h3>
                <div class="button-event-container">
                    <div class="button-event-toolbar">
                        <button class="btn btn-primary" onclick="addButtonEvent()">+ ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ </button>
                    </div>
                    <table id="buttonEventTable" class="button-event-table">
                        <thead>
                            <tr>
                                <th>ãƒœã‚¿ãƒ³å</th>
                                <th>ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ</th>
                                <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                            </tr>
                        </thead>
                        <tbody id="buttonEventList">
                            <!-- ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãŒã“ã“ã«è¿½åŠ ã•ã‚Œã‚‹ -->
                        </tbody>
                    </table>
                    <p id="noButtonEvents" class="no-data">ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
                </div>
            </div>

            <div id="windowButtonGroup" class="window-button-group" style="display: none;">
                <button class="btn btn-cancel" onclick="discardWindowChanges()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="btn btn-save" onclick="saveWindowChanges()">ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’æ›´æ–°</button>
                <button class="btn btn-danger" onclick="forceCloseMenu()" style="margin-left: 10px;">ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¼·åˆ¶çµ‚äº†</button>
            </div>
        </div>
    </div>

    <!-- ButtonEventãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="buttonEventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="buttonEventModalTitle">ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç·¨é›†</h2>
                <button class="modal-close" onclick="closeButtonEventModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒœã‚¿ãƒ³å
                            <span class="tooltiptext">æŠ¼ã—ãŸã¨ãã«ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã™ã‚‹ãƒœã‚¿ãƒ³åã§ã™ã€‚okã¨cancelã¯ã‚¿ãƒƒãƒæ“ä½œã¨æ±ºå®šã¨ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã«ã‚‚åå¿œã—ã¾ã™ã€‚</span>
                        </label>
                        <select id="buttonEventName" class="form-select">
                            <option value="">-- é¸æŠ --</option>
                            <option value="ok">ok</option>
                            <option value="cancel">cancel</option>
                            <option value="menu">menu</option>
                            <option value="shift">shift</option>
                            <option value="control">control</option>
                            <option value="down">down</option>
                            <option value="left">left</option>
                            <option value="right">right</option>
                            <option value="up">up</option>
                            <option value="pageup">pageup</option>
                            <option value="pagedown">pagedown</option>
                            <option value="debug">debug</option>
                            <option value="tab">tab</option>
                        </select>
                    </div>
                </div>

                <h4 class="subsection-title">ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š</h4>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                            <span class="tooltiptext">ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚</span>
                        </label>
                        <input type="number" id="buttonEventCommandId" class="form-input" min="0">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ID
                            <span class="tooltiptext">ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã§ã™ã€‚</span>
                        </label>
                        <select id="buttonEventFocusWindowId" class="form-select">
                            <option value="">(æŒ‡å®šãªã—)</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                            <span class="tooltiptext">ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œå¾Œã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ã§ã™ã€‚-1ã§æ“ä½œã—ã¾ã›ã‚“ã€‚</span>
                        </label>
                        <input type="number" id="buttonEventFocusWindowIndex" class="form-input" min="-1" value="-1">
                    </div>

                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚¹ã‚¤ãƒƒãƒ
                            <span class="tooltiptext">ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«ONã«ãªã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚</span>
                        </label>
                        <input type="number" id="buttonEventSwitchId" class="form-input" min="0">
                    </div>
                </div>
                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                        </label>
                        <textarea id="buttonEventScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: console.log('ãƒœã‚¿ãƒ³æŠ¼ä¸‹');"></textarea>
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <select id="buttonEventScriptTemplate" class="form-select">
                                    <option value="">-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ --</option>
                                    <option value="SceneManager.callCustomMenu('Scene___'); // åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ç§»å‹•">
                                        åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ç§»å‹•
                                    </option>
                                    <option value="this.popScene(); // å…ƒã®ã‚·ãƒ¼ãƒ³ã«æˆ»ã‚‹">å…ƒã®ã‚·ãƒ¼ãƒ³ã«æˆ»ã‚‹</option>
                                    <option value="SceneManager.goto(Scene_Map); // ãƒãƒƒãƒ—ç”»é¢ã«é·ç§»">ãƒãƒƒãƒ—ç”»é¢ã«é·ç§»</option>
                                    <option value="SceneManager.changeWindowFocus('window1'); // æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹">
                                        æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
                                    </option>
                                    <option value="SceneManager.changeWindowIndex('window1', 1); // æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´">
                                        æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´</option>
                                    <option value="SceneManager.trashScene(); // å…ƒã®ã‚·ãƒ¼ãƒ³æƒ…å ±ã‚’ç ´æ£„ã™ã‚‹">å…ƒã®ã‚·ãƒ¼ãƒ³æƒ…å ±ã‚’ç ´æ£„ã™ã‚‹</option>
                                    <option
                                        value="SceneManager.showMapPicture(1, '', 0, 0, 0, 100, 100, 255, 1); // ãƒãƒƒãƒ—ç”»é¢ã«ãƒ”ã‚¯ãƒãƒ£ã‚’è¡¨ç¤º">
                                        ãƒãƒƒãƒ—ç”»é¢ã«ãƒ”ã‚¯ãƒãƒ£ã‚’è¡¨ç¤º</option>
                                    <option value="this.executeSave(v(1)); // ã‚»ãƒ¼ãƒ–å®Ÿè¡Œ">ã‚»ãƒ¼ãƒ–å®Ÿè¡Œ</option>
                                    <option value="this.executeLoad(v(1)); // ãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ">ãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            å…ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é¸æŠè§£é™¤
                            <span class="tooltiptext">ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆå®Ÿè¡Œæ™‚ã«å…ƒã€…ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã¦ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤ã—ã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="buttonEventDeselect" style="width: auto;">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeButtonEventModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="btn btn-save" onclick="saveButtonEventModal()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- ã‚³ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="commandListModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="commandListModalTitle">ã‚³ãƒãƒ³ãƒ‰ç·¨é›†</h2>
                <button class="modal-close" onclick="closeCommandListModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            é …ç›®å†…å®¹
                            <span class="tooltiptext">é …ç›®ã®æç”»å†…å®¹ã§ã™ã€‚ã‚¢ã‚¤ã‚³ãƒ³ç³»ã®åˆ¶å¾¡æ–‡å­—ãŒä½¿ç”¨ã§ãã¾ã™ã€‚</span>
                        </label>
                        <input type="text" id="commandListText" class="form-input" placeholder="ä¾‹: ã¯ã„">
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            é …ç›®ã®æƒãˆ
                            <span class="tooltiptext">é …ç›®ã®æƒãˆã§ã™ã€‚</span>
                        </label>
                        <select id="commandListAlign" class="form-input">
                            <option value="0">å·¦æƒãˆ</option>
                            <option value="1">ä¸­å¤®æƒãˆ</option>
                            <option value="2">å³æƒãˆ</option>
                        </select>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆ
                            <span class="tooltiptext">ãƒ˜ãƒ«ãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹å ´åˆã€ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</span>
                        </label>
                        <textarea id="commandListHelpText" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚"></textarea>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            è¡¨ç¤ºã‚¹ã‚¤ãƒƒãƒID
                            <span class="tooltiptext">æŒ‡å®šã—ãŸã‚¹ã‚¤ãƒƒãƒãŒONã®å ´åˆã®ã¿è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚0ã§å¸¸ã«è¡¨ç¤ºã€‚</span>
                        </label>
                        <input type="number" id="commandListVisibleSwitchId" class="form-input" min="0" value="0">
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            è¡¨ç¤ºã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span
                                class="tooltiptext">æŒ‡å®šã—ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒtrueã®å ´åˆã®ã¿ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚å¤‰æ•°[item]ã§ã€ä¸€è¦§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã€ã®é¸æŠé …ç›®ãŒå‚ç…§ã§ãã¾ã™ã€‚</span>
                        </label>
                        <textarea id="commandListVisibleScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: item.meta['value'];"></textarea>
                        <div class="form-row" style="margin-top: 10px;">
                            <div class="form-group" style="flex: 1;">
                                <select id="commandListVisibleScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            é¸æŠå¯èƒ½ã‚¹ã‚¤ãƒƒãƒID
                            <span class="tooltiptext">æŒ‡å®šã—ãŸã‚¹ã‚¤ãƒƒãƒãŒONã®å ´åˆã®ã¿é¸æŠã§ãã¾ã™ã€‚OFFã ã¨é¸æŠç¦æ­¢ã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="number" id="commandListEnableSwitchId" class="form-input" min="0" value="0">
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            é¸æŠå¯èƒ½ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">é …ç›®ã‚’é¸æŠå¯èƒ½ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚å¤‰æ•°[item]ã§ã€ä¸€è¦§ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã€ã®é¸æŠé …ç›®ãŒå‚ç…§ã§ãã¾ã™ã€‚</span>
                        </label>
                        <textarea id="commandListIsEnableScript" class="form-input" style="height: 60px;"
                            placeholder="ä¾‹: true  // å¸¸ã«é¸æŠå¯èƒ½"></textarea>
                        <div class="form-row" style="margin-top: 10px;">
                            <div class="form-group" style="flex: 1;">
                                <select id="commandListIsEnableScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«é¸æŠè‚¢
                            <span class="tooltiptext">ã“ã®é …ç›®ã‚’é¸æŠã—ãŸã¨ãã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã€‚</span>
                        </label>
                        <input type="checkbox" id="commandListCancelChoice" style="width: auto;">
                    </div>
                </div>

                <div style="display: flex; align-items: center; margin-bottom: 10px;">
                    <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                        æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆ
                        <span class="tooltiptext">ã“ã®é …ç›®ãŒæ±ºå®šã•ã‚ŒãŸç¬é–“ã«ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚æŒ‡å®šã—ãŸå ´åˆã€å…±é€šã®æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆã‚ˆã‚Šå„ªå…ˆã•ã‚Œã¾ã™ã€‚</span>
                    </label>
                    <input type="checkbox" id="commandListDecisionEventEnabled"
                        onchange="toggleSection('commandListDecisionEventEnabled', 'commandListDecisionEventContainer')">
                </div>
                <div id="commandListDecisionEventContainer">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label tooltip">
                                ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
                                <span class="tooltiptext">å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¢ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚ãŸã ã—ã€ã‚·ãƒ¼ãƒ³ã‚’å‡ºã‚‹ã¨ãã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚</span>
                            </label>
                            <input type="number" id="commandListDecisionCommandId" class="form-input" min="0">
                        </div>

                        <div class="form-group">
                            <label class="form-label tooltip">
                                ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­
                                <span class="tooltiptext">å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã¨ãã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã§ã™ã€‚æŒ‡å®šãŒãªã‘ã‚Œã°å‰ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«æˆ»ã‚Šã¾ã™ã€‚</span>
                            </label>
                            <select id="commandListDecisionFocusWindowId" class="form-select">
                                <option value="">(æŒ‡å®šãªã—)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label tooltip">
                                ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
                                <span
                                    class="tooltiptext">å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã¨ãã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ã™ã€‚-1ã‚’æŒ‡å®šã—ãŸå ´åˆã€æ“ä½œã—ã¾ã›ã‚“ã€‚</span>
                            </label>
                            <input type="number" id="commandListDecisionFocusWindowIndex" class="form-input" min="-1"
                                value="-1">
                        </div>

                        <div class="form-group">
                            <label class="form-label tooltip">
                                ã‚¹ã‚¤ãƒƒãƒ
                                <span class="tooltiptext">å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã¨ãã«ONã«ãªã‚‹ã‚¹ã‚¤ãƒƒãƒã§ã™ã€‚</span>
                            </label>
                            <input type="number" id="commandListDecisionSwitchId" class="form-input" min="0">
                        </div>
                    </div>
                    <div class="form-row full">
                        <div class="form-group">
                            <label class="form-label tooltip">
                                ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                                <span class="tooltiptext">å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã¨ãã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                            </label>
                            <textarea id="commandListDecisionScript" class="form-input" style="height: 60px;"
                                placeholder="ä¾‹: SceneManager.callCustomMenu('Scene_Menu');"></textarea>
                            <div class="form-row">
                                <div class="form-group" style="flex: 1;">
                                    <select id="commandListDecisionScriptTemplate" class="form-select"></select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label tooltip">
                                å…ƒã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é¸æŠè§£é™¤
                                <span class="tooltiptext">å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã—ãŸã¨ãã«å…ƒã€…ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã•ã‚Œã¦ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é¸æŠçŠ¶æ…‹ã‚’è§£é™¤ã—ã¾ã™ã€‚</span>
                            </label>
                            <input type="checkbox" id="commandListDecisionDeselect" style="width: auto;">
                        </div>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <div style="display: flex; align-items: center; margin-bottom: 6px;">
                            <label class="form-label tooltip" style="margin-bottom: 0; margin-right: 10px;">
                                æ±ºå®šSE
                                <span class="tooltiptext">é¸æŠã™ã‚‹ã¨é€šå¸¸ã®æ±ºå®šéŸ³ã®ä»£ã‚ã‚Šã«æŒ‡å®šã—ãŸSEãŒæ¼”å¥ã•ã‚Œã¾ã™ã€‚</span>
                            </label>
                            <input type="checkbox" id="commandListOkSoundEnabled"
                                onchange="toggleSection('commandListOkSoundEnabled', 'commandListOkSoundContainer')">
                        </div>
                        <div id="commandListOkSoundContainer" style="margin-top: 6px;">
                            <div style="margin-bottom: 8px;">
                                <label style="font-size: 12px;">ãƒ•ã‚¡ã‚¤ãƒ«å:</label>
                                <input type="text" id="commandListOkSoundName" class="form-input"
                                    placeholder="ä¾‹: Cursor1">
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <div style="flex: 1;">
                                    <label style="font-size: 12px;">éŸ³é‡:</label>
                                    <input type="number" id="commandListOkSoundVolume" class="form-input" min="0"
                                        max="100" value="90">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 12px;">ãƒ”ãƒƒãƒ:</label>
                                    <input type="number" id="commandListOkSoundPitch" class="form-input" min="50"
                                        max="150" value="100">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 12px;">ä½ç›¸:</label>
                                    <input type="number" id="commandListOkSoundPan" class="form-input" min="-100"
                                        max="100" value="0">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeCommandListModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="btn btn-save" onclick="saveCommandListModal()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è¿½åŠ ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="wizardModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è¿½åŠ ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰</h2>
                <button class="modal-close" onclick="closeWizardModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="wizardQuestion" style="margin-bottom: 15px; color: #4ec9b0; font-weight: bold;"></p>
                <div id="wizardInputs"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" id="wizardBackBtn" onclick="wizardBack()">æˆ»ã‚‹</button>
                <button class="btn btn-save" id="wizardNextBtn" onclick="wizardNext()">æ¬¡ã¸</button>
            </div>
        </div>
    </div>

    <div id="itemDrawScriptModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="itemDrawScriptModalTitle">é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆç·¨é›†</h2>
                <span class="modal-close" onclick="closeItemDrawScriptModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-row full">
                    <div class="form-group">
                        <label class="form-label tooltip">
                            ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
                            <span class="tooltiptext">é …ç›®ã‚’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«æç”»ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚</span>
                        </label>
                        <textarea id="itemDrawScriptText" class="form-input" style="height: 100px;"
                            placeholder="ä¾‹: this.drawActorSimpleStatus(item, r.x, r.y, r.width);"></textarea>
                        <div class="form-row" style="margin-top: 10px;">
                            <div class="form-group" style="flex: 1;">
                                <select id="itemDrawScriptTemplate" class="form-select"></select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-cancel" onclick="closeItemDrawScriptModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button class="btn btn-save" onclick="saveItemDrawScriptModal()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <div id="statusContainer" class="section">
        <p id="statusText" class="no-data">ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
    </div>

    <script>
        let currentCustomData = null;
        let currentSceneKey = null;
        let gameWindow = window.opener;
        let currentButtonEventIndex = -1;
        let currentItemDrawScriptIndex = -1;
        let currentCommandListIndex = -1;
        let commandListCurrentDecisionEvent = {};
        let wizardStep = 0;
        let wizardData = {};

        // ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®šç¾©
        const SCRIPT_TEMPLATES = [
            { label: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ', value: '' },
            { label: 'åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ç§»å‹•', value: "SceneManager.callCustomMenu('Scene___'); // åˆ¥ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«ç§»å‹•" },
            { label: 'å…ƒã®ã‚·ãƒ¼ãƒ³ã«æˆ»ã‚‹', value: 'this.popScene(); // å…ƒã®ã‚·ãƒ¼ãƒ³ã«æˆ»ã‚‹' },
            { label: 'ãƒãƒƒãƒ—ç”»é¢ã«é·ç§»', value: 'SceneManager.goto(Scene_Map); // ãƒãƒƒãƒ—ç”»é¢ã«é·ç§»' },
            { label: 'æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹', value: "SceneManager.changeWindowFocus('window1'); // æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹" },
            { label: 'æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´', value: "SceneManager.changeWindowIndex('window1', 1); // æŒ‡å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å¤‰æ›´" },
            { label: 'å…ƒã®ã‚·ãƒ¼ãƒ³æƒ…å ±ã‚’ç ´æ£„ã™ã‚‹', value: 'SceneManager.trashScene(); // å…ƒã®ã‚·ãƒ¼ãƒ³æƒ…å ±ã‚’ç ´æ£„ã™ã‚‹' },
            { label: 'ãƒãƒƒãƒ—ç”»é¢ã«ãƒ”ã‚¯ãƒãƒ£ã‚’è¡¨ç¤º', value: "SceneManager.showMapPicture(1, '', 0, 0, 0, 100, 100, 255, 1); // ãƒãƒƒãƒ—ç”»é¢ã«ãƒ”ã‚¯ãƒãƒ£ã‚’è¡¨ç¤º" },
            { label: 'ã‚»ãƒ¼ãƒ–å®Ÿè¡Œ', value: 'this.executeSave(v(1)); // ã‚»ãƒ¼ãƒ–å®Ÿè¡Œ' },
            { label: 'ãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ', value: 'this.executeLoad(v(1)); // ãƒ­ãƒ¼ãƒ‰å®Ÿè¡Œ' }
        ];

        const LIST_SCRIPT_TEMPLATES = [
            { label: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ', value: '' },
            { label: 'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¡ãƒ³ãƒãƒ¼', value: '$gameParty.members(); // ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¡ãƒ³ãƒãƒ¼' },
            { label: 'æˆ¦é—˜ãƒ¡ãƒ³ãƒãƒ¼', value: '$gameParty.battleMembers(); // æˆ¦é—˜ãƒ¡ãƒ³ãƒãƒ¼' },
            { label: 'æ§ãˆãƒ¡ãƒ³ãƒãƒ¼', value: '$gameParty.reserveMembers(); // ãƒªã‚¶ãƒ¼ãƒ–ãƒ¡ãƒ³ãƒãƒ¼' },
            { label: 'æ‰€æŒã‚¢ã‚¤ãƒ†ãƒ ', value: '$gameParty.items(); // æ‰€æŒæ¶ˆè€—å“' },
            { label: 'æ‰€æŒæ­¦å™¨', value: '$gameParty.weapons(); // æ‰€æŒæ­¦å™¨' },
            { label: 'æ‰€æŒé˜²å…·', value: '$gameParty.armors(); // æ‰€æŒé˜²å…·' },
            { label: 'æ‰€æŒè£…å‚™å“', value: '$gameParty.equipItems(); // æ‰€æŒè£…å‚™å“' },
            { label: 'å…¨æ‰€æŒã‚¢ã‚¤ãƒ†ãƒ ', value: '$gameParty.allItems(); // æ‰€æŒã‚¢ã‚¤ãƒ†ãƒ ' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ã‚¢ã‚¯ã‚¿ãƒ¼', value: '[this._actor]; // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: è£…å‚™æ­¦å™¨', value: 'this._actor.weapons(); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã®è£…å‚™æ­¦å™¨' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: è£…å‚™é˜²å…·', value: 'this._actor.armors(); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã®è£…å‚™é˜²å…·' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: è£…å‚™å“', value: 'this._actor.equips(); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã®è£…å‚™å“' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆ', value: 'this._actor.equipSlots(); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã®è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆID' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ã‚¹ã‚­ãƒ«', value: 'this._actor.skills(); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã®æ‰€æŒã‚¹ã‚­ãƒ«' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ä½¿ç”¨å¯èƒ½ã‚¹ã‚­ãƒ«', value: 'this._actor.usableSkills(); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã®ä½¿ç”¨å¯èƒ½ã‚¹ã‚­ãƒ«' },
            { label: 'ãƒ¡ãƒ‹ãƒ¥ãƒ¼: è·æ¥­ã‚¹ã‚­ãƒ«', value: 'this._actor.currentClass().learnings; //ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã®è·æ¥­ã®ç¿’å¾—ã‚¹ã‚­ãƒ«' },
            { label: 'æŒ‡å®šPTãƒ¡ãƒ³ãƒãƒ¼ã®è£…å‚™æ­¦å™¨', value: '$gameParty.members()[v(1)].weapons(); // å¤‰æ•°[1]ã®PTãƒ¡ãƒ³ãƒãƒ¼ã®è£…å‚™æ­¦å™¨' },
            { label: 'ã‚»ãƒ¼ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§', value: 'this.createSaveFiles(); // ã‚»ãƒ¼ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§' },
            { label: 'DB: ã‚¢ã‚¯ã‚¿ãƒ¼', value: '$dataActors.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚¿ãƒ¼' },
            { label: 'DB: è·æ¥­', value: '$dataClasses.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®è·æ¥­' },
            { label: 'DB: ã‚¹ã‚­ãƒ«', value: '$dataSkills.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ã‚­ãƒ«' },
            { label: 'DB: ã‚¢ã‚¤ãƒ†ãƒ ', value: '$dataItems.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¤ãƒ†ãƒ ' },
            { label: 'DB: æ­¦å™¨', value: '$dataWeapons.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ­¦å™¨' },
            { label: 'DB: é˜²å…·', value: '$dataArmors.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®é˜²å…·' },
            { label: 'DB: ã‚¢ã‚¤ãƒ†ãƒ ãƒ»æ­¦å™¨é˜²å…·', value: '$dataItems.concat($dataWeapons, $dataArmors).filter(data => !!data); // ã‚¢ã‚¤ãƒ†ãƒ ã€æ­¦å™¨é˜²å…·' },
            { label: 'DB: æ•µã‚­ãƒ£ãƒ©', value: '$dataEnemies.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ•µã‚­ãƒ£ãƒ©' },
            { label: 'DB: æ•µã‚°ãƒ«ãƒ¼ãƒ—', value: '$dataTroops.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ•µã‚°ãƒ«ãƒ¼ãƒ—' },
            { label: 'DB: ã‚¹ãƒ†ãƒ¼ãƒˆ', value: '$dataStates.filter(data => !!data); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¹ãƒ†ãƒ¼ãƒˆ' },
            { label: 'ç”¨èª: æ­¦å™¨ã‚¿ã‚¤ãƒ—', value: '$dataSystem.weaponTypes.filter((d, i) => i > 0); // æ­¦å™¨ã‚¿ã‚¤ãƒ—' },
            { label: 'ç”¨èª: é˜²å…·ã‚¿ã‚¤ãƒ—', value: '$dataSystem.armorTypes.filter((d, i) => i > 0); // é˜²å…·ã‚¿ã‚¤ãƒ—' },
            { label: 'ç”¨èª: ã‚¹ã‚­ãƒ«ã‚¿ã‚¤ãƒ—', value: '$dataSystem.skillTypes.filter((d, i) => i > 0); // ã‚¹ã‚­ãƒ«ã‚¿ã‚¤ãƒ—' },
            { label: 'ç”¨èª: è£…å‚™ã‚¿ã‚¤ãƒ—', value: '$dataSystem.equipTypes.filter((d, i) => i > 0); // è£…å‚™ã‚¿ã‚¤ãƒ—' },
            { label: 'ç”¨èª: å±æ€§', value: '$dataSystem.elements.filter((d, i) => i > 0); // å±æ€§' },
            { label: 'ç”¨èª: èƒ½åŠ›å€¤', value: '$dataSystem.params; // èƒ½åŠ›å€¤(ç”¨èª)' },
            { label: 'ç”¨èª: ã‚³ãƒãƒ³ãƒ‰', value: '$dataSystem.commands; // ã‚³ãƒãƒ³ãƒ‰(ç”¨èª)' },
            { label: 'ç”¨èª: åŸºæœ¬ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹', value: '$dataSystem.basic; // åŸºæœ¬ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹(ç”¨èª)' },
            { label: 'ãƒ„ã‚¯: ã‚¹ã‚¤ãƒƒãƒå', value: '$dataSystem.switches; // ã‚¹ã‚¤ãƒƒãƒå' },
            { label: 'ãƒ„ã‚¯: å¤‰æ•°å', value: '$dataSystem.variables; // å¤‰æ•°å' },
        ];

        const FILTER_ENABLE_SCRIPT_TEMPLATES = [
            { label: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ', value: '' },
            { label: 'ãƒ¡ãƒ¢æ¬„ã«<value>ãŒã‚ã‚‹', value: "item.meta['value']; // ãƒ¡ãƒ¢æ¬„ã«<value>ã®è¨˜è¿°ãŒã‚ã‚‹" },
            { label: 'åå‰ã«"value"ã‚’å«ã‚€', value: "item.name.match('value'); // åå‰ã«valueã‚’å«ã‚€" },
            { label: 'IDãŒå¤‰æ•°[10]ã‚ˆã‚Šå¤§ãã„', value: 'item.id > v(10); // IDãŒå¤‰æ•°[10]ã®å€¤ã‚ˆã‚Šå¤§ãã„' },
            { label: 'ãƒ¡ãƒ¢æ¬„<value:n>ã®ã‚¹ã‚¤ãƒƒãƒON', value: "s(parseInt(item.meta['value'])); // <value:n>ã®ã‚¹ã‚¤ãƒƒãƒãŒON" },
            { label: 'ç©ºæ–‡å­—ä»¥å¤–', value: "item !== ''; // ç©ºæ–‡å­—ä»¥å¤–" },
            { label: 'ç©ºã§ãªã„', value: '!!item; // null, undefined, 0, ç©ºæ–‡å­—ä»¥å¤–' },
            { label: 'ã‚¹ã‚­ãƒ«ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã¨ä¸€è‡´', value: 'item.stypeId === v(10); // ã‚¹ã‚­ãƒ«ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã®å€¤ã¨ç­‰ã—ã„' },
            { label: 'è£…å‚™ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã¨ä¸€è‡´', value: 'item.etypeId === v(10); // è£…å‚™ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã®å€¤ã¨ç­‰ã—ã„' },
            { label: 'æ­¦å™¨ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã¨ä¸€è‡´', value: 'item.wtypeId === v(10); // æ­¦å™¨ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã®å€¤ã¨ç­‰ã—ã„' },
            { label: 'é˜²å…·ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã¨ä¸€è‡´', value: 'item.atypeId === v(10); // é˜²å…·ã‚¿ã‚¤ãƒ—ãŒå¤‰æ•°[10]ã®å€¤ã¨ç­‰ã—ã„' },
            { label: 'ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—ãŒ[é€šå¸¸ã‚¢ã‚¤ãƒ†ãƒ ]', value: 'item.itypeId === 1; // ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—ãŒ[é€šå¸¸ã‚¢ã‚¤ãƒ†ãƒ ]' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ãŒè£…å‚™å¯èƒ½', value: 'this._actor.canEquip(item); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ãŒè£…å‚™å¯èƒ½' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ãŒä½¿ç”¨å¯èƒ½', value: 'this._actor.canUse(item); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ãŒä½¿ç”¨å¯èƒ½' },
        ];

        const MAPPING_SCRIPT_TEMPLATES = [
            { label: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ', value: '' },
            { label: 'Game_Actorã‚’DBã®Actorã«å¤‰æ›', value: 'item.actor(); // Game_Actorã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®Actorã«å¤‰æ›' },
            { label: 'ç¿’å¾—ã‚¹ã‚­ãƒ«ã‚’DBã®Skillã«å¤‰æ›', value: '$dataSkills[item.skillId]; // ç¿’å¾—ã‚¹ã‚­ãƒ«æƒ…å ±ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®Skillã«å¤‰æ›' },
            { label: 'è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆIDã‚’åç§°ã«å¤‰æ›', value: '$dataSystem.equipTypes[item]; // è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆIDã‚’è£…å‚™ã‚¹ãƒ­ãƒƒãƒˆåç§°ã«å¤‰æ›' },
        ];

        const SORT_SCRIPT_TEMPLATES = [
            { label: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ', value: '' },
            { label: 'IDé †', value: 'a.id - b.id; // IDé †' },
            { label: 'åå‰é †', value: "a.name.localeCompare(b.name); // åå‰é †" },
            { label: 'ãƒ¡ãƒ¢æ¬„<order:n>é †', value: "this.intMeta(a,'order') - this.intMeta(b,'order'); // ãƒ¡ãƒ¢æ¬„ã®orderé †" },
            { label: 'å€¤æ®µé †', value: 'a.price - b.price; // å€¤æ®µé †' },
            { label: 'HPé †', value: 'a.params[0] - b.params[0]; // HPé †' },
            { label: 'MPé †', value: 'a.params[1] - b.params[1]; // MPé †' },
            { label: 'æ”»æ’ƒåŠ›é †', value: 'a.params[2] - b.params[2]; // æ”»æ’ƒåŠ›é †' },
            { label: 'é˜²å¾¡åŠ›é †', value: 'a.params[3] - b.params[3]; // é˜²å¾¡åŠ›é †' },
            { label: 'é­”æ³•åŠ›é †', value: 'a.params[4] - b.params[4]; // é­”æ³•åŠ›é †' },
            { label: 'é­”æ³•é˜²å¾¡é †', value: 'a.params[5] - b.params[5]; // é­”æ³•é˜²å¾¡é †' },
            { label: 'æ•æ·æ€§é †', value: 'a.params[6] - b.params[6]; // æ•æ·æ€§é †' },
            { label: 'é‹é †', value: 'a.params[7] - b.params[7]; // é‹é †' },
        ];

        const ITEM_DRAW_SCRIPT_TEMPLATES = [
            { label: 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é¸æŠ', value: '' },
            { label: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼', value: 'this.drawCharacter(item.characterName(), item.characterIndex(), r.x, r.y); // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼', value: 'this.drawActorCharacter(item, r.x + 24, r.y + 48); // ã‚¢ã‚¯ã‚¿ãƒ¼ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼(ãƒ¡ãƒ‹ãƒ¥ãƒ¼)', value: 'this.drawActorCharacter(this._actor, r.x, r.y); // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§é¸æŠã—ãŸã‚¢ã‚¯ã‚¿ãƒ¼ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹', value: 'this.drawActorFace(item, r.x, r.y); // ã‚¢ã‚¯ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼å', value: 'this.drawActorName(item, r.x, r.y); // ã‚¢ã‚¯ã‚¿ãƒ¼åç§°' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼è·æ¥­', value: 'this.drawActorClass(item, r.x, r.y); // ã‚¢ã‚¯ã‚¿ãƒ¼è·æ¥­' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ã®äºŒã¤å', value: 'this.drawActorNickname(item, r.x, r.y); // ã‚¢ã‚¯ã‚¿ãƒ¼ã®äºŒã¤å' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ã®ãƒ¬ãƒ™ãƒ«', value: 'this.drawActorLevel(item, r.x, r.y); // ã‚¢ã‚¯ã‚¿ãƒ¼ã®ãƒ¬ãƒ™ãƒ«' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ã®ã‚¹ãƒ†ãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³', value: 'this.drawActorIcons(item, r.x, r.y); // ã‚¢ã‚¯ã‚¿ãƒ¼ã®ã‚¹ãƒ†ãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³' },
            { label: 'ã‚¢ã‚¯ã‚¿ãƒ¼ã®ç°¡æ˜“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹', value: 'this.drawActorSimpleStatus(item, r.x, r.y, r.width); // ã‚¢ã‚¯ã‚¿ãƒ¼ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹' },
            { label: 'ã‚¢ã‚¤ã‚³ãƒ³', value: 'this.drawIcon(item.iconIndex, r.x, r.y, r.width); // ã‚¢ã‚¤ã‚³ãƒ³' },
            { label: 'ãƒ•ã‚§ã‚¤ã‚¹ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯', value: 'this.drawFace(item.faceName(), item.faceIndex(), r.x, r.y); // ãƒ•ã‚§ã‚¤ã‚¹ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯' },
            { label: 'æ•µã‚­ãƒ£ãƒ©ã®ç”»åƒ', value: "this.drawEnemy(r.x, r.y, 'center', 'bottom'); // æ•µã‚­ãƒ£ãƒ©ã®ç”»åƒ" },
            { label: 'DBãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿', value: "this.drawParam(0, r.x, r.y, 'right'); // DBãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿(0:HP 1:MP...)" },
            { label: 'ã‚¢ã‚¤ãƒ†ãƒ åãƒ»ã‚¹ã‚­ãƒ«å', value: 'this.drawItemName(item, r.x, r.y, r.width); // ã‚¢ã‚¤ãƒ†ãƒ ã€ã‚¹ã‚­ãƒ«åç§°(ã‚¢ã‚¤ã‚³ãƒ³å«ã‚€)' },
            { label: 'ã‚¢ã‚¤ãƒ†ãƒ ã®æ‰€æŒæ•°', value: "this.drawText($gameParty.numItems(item), r.x, r.y, r.width, 'right'); // ã‚¢ã‚¤ãƒ†ãƒ ã®æ‰€æŒæ•°" },
            { label: 'ä»»æ„ã®ãƒ†ã‚­ã‚¹ãƒˆ', value: "this.drawTextEx(`Text:${item.name}`, r.x, r.y, r.width); // ä»»æ„ã®ãƒ†ã‚­ã‚¹ãƒˆæç”»(åˆ¶å¾¡æ–‡å­—å¤‰æ›ã‚ã‚Š)" },
            { label: 'ä»»æ„ã®ãƒ†ã‚­ã‚¹ãƒˆ(å³æƒãˆ)', value: "this.drawText(`Text:${item.name}`, r.x, r.y, r.width, 'right'); // ä»»æ„ã®ãƒ†ã‚­ã‚¹ãƒˆæç”»(åˆ¶å¾¡æ–‡å­—å¤‰æ›ãªã—ã€‚å³æƒãˆ)" },
            { label: 'ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ¼å¤‰æ›´', value: 'this.changeTextColor(ColorManager.textColor(1)); // ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ¼å¤‰æ›´(drawTextã§ã®ã¿æœ‰åŠ¹)' },
            { label: 'åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®é …ç›®', value: "this.drawText(this.findWindowItem('window1').name, r.x, r.y, r.width); // åˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é¸æŠã—ã¦ã„ã‚‹é …ç›®å" },
            { label: 'ãƒ¡ãƒ¢æ¬„ã®ãƒ”ã‚¯ãƒãƒ£', value: "this.drawNotePicture('noteValue', r.x, r.y, 'left', 'center', 1.0, 1.0); // æŒ‡å®šã—ãŸãƒ¡ãƒ¢æ¬„ã®ãƒ”ã‚¯ãƒãƒ£ã‚’æç”»" },
            { label: 'æˆ¦é—˜: ã‚¢ã‚¯ã‚¿ãƒ¼å', value: 'this.placeActorName(item, r.x, r.y); // ã‚¢ã‚¯ã‚¿ãƒ¼åç§°(æˆ¦é—˜ç”¨)' },
            { label: 'æˆ¦é—˜: ã‚¹ãƒ†ãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³', value: 'this.placeStateIcon(item, r.x, r.y); // ã‚¹ãƒ†ãƒ¼ãƒˆã‚¢ã‚¤ã‚³ãƒ³(æˆ¦é—˜ç”¨)' },
            { label: 'æˆ¦é—˜: HPã‚²ãƒ¼ã‚¸', value: "this.placeGauge(item, 'hp', r.x, r.y); // HPã‚²ãƒ¼ã‚¸(æˆ¦é—˜ç”¨)" },
            { label: 'æˆ¦é—˜: ã‚²ãƒ¼ã‚¸ã‚»ãƒƒãƒˆ', value: 'this.placeBasicGauges(item, r.x, r.y); // ã‚²ãƒ¼ã‚¸ã‚»ãƒƒãƒˆ(æˆ¦é—˜ç”¨)' },
            { label: 'ãƒ¡ãƒ¢æ¬„ã®ãƒ†ã‚­ã‚¹ãƒˆ', value: "this.drawNoteText('noteValue', r.x, r.y); // æŒ‡å®šã—ãŸãƒ¡ãƒ¢æ¬„ã®å†…å®¹ã‚’æç”»" },
            { label: 'ãƒ¡ãƒ¢æ¬„ã®ãƒ†ã‚­ã‚¹ãƒˆ(å³å¯„ã›)', value: "this.drawNoteText('noteValue', r.x, r.y, 'right'); // ãƒ¡ãƒ¢æ¬„ã®å†…å®¹ã‚’å³å¯„ã›æç”»" },
            { label: 'ã‚»ãƒ¼ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±', value: 'this.drawSavefileInfo(item, r.x, r.y, r.width); // ã‚»ãƒ¼ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’æç”»' },
        ];

        const SCRIPT_INSERT_MAP = {
            'sceneInitialScriptTemplate': 'sceneInitialScript',
            'sceneActorChangeScriptTemplate': 'sceneActorChangeScript',
            'decisionScriptTemplate': 'decisionScript',
            'cancelScriptTemplate': 'cancelScript',
            'cursorScriptTemplate': 'cursorScript',
            'buttonEventScriptTemplate': 'buttonEventScript',
            'listScriptTemplate': 'windowListScript',
            'filterScriptTemplate': 'windowFilterScript',
            'mappingScriptTemplate': 'windowMappingScript',
            'sortScriptTemplate': 'windowSortScript',
            'itemDrawScriptTemplate': 'itemDrawScriptText',
            'itemDrawMultiLineScriptTemplate': 'windowItemDrawMultiLineScript',
            'isEnableScriptTemplate': 'windowIsEnableScript',
            'commandListVisibleScriptTemplate': 'commandListVisibleScript',
            'commandListIsEnableScriptTemplate': 'commandListIsEnableScript',
            'commandListDecisionScriptTemplate': 'commandListDecisionScript',
        };

        // ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’åˆæœŸåŒ–
        function initializeScriptTemplateSelects() {
            const templateMap = {
                'sceneInitialScriptTemplate': SCRIPT_TEMPLATES,
                'sceneActorChangeScriptTemplate': SCRIPT_TEMPLATES,
                'decisionScriptTemplate': SCRIPT_TEMPLATES,
                'cancelScriptTemplate': SCRIPT_TEMPLATES,
                'cursorScriptTemplate': SCRIPT_TEMPLATES,
                'buttonEventScriptTemplate': SCRIPT_TEMPLATES,
                'listScriptTemplate': LIST_SCRIPT_TEMPLATES,
                'filterScriptTemplate': FILTER_ENABLE_SCRIPT_TEMPLATES,
                'mappingScriptTemplate': MAPPING_SCRIPT_TEMPLATES,
                'sortScriptTemplate': SORT_SCRIPT_TEMPLATES,
                'itemDrawScriptTemplate': ITEM_DRAW_SCRIPT_TEMPLATES,
                'itemDrawMultiLineScriptTemplate': ITEM_DRAW_SCRIPT_TEMPLATES,
                'isEnableScriptTemplate': FILTER_ENABLE_SCRIPT_TEMPLATES,
                'commandListVisibleScriptTemplate': FILTER_ENABLE_SCRIPT_TEMPLATES,
                'commandListIsEnableScriptTemplate': FILTER_ENABLE_SCRIPT_TEMPLATES,
                'commandListDecisionScriptTemplate': SCRIPT_TEMPLATES,
            };

            for (const selectId in SCRIPT_INSERT_MAP) {
                const textareaId = SCRIPT_INSERT_MAP[selectId];
                const selectElement = document.getElementById(selectId);
                const templates = templateMap[selectId];

                if (selectElement && templates) {
                    selectElement.innerHTML = '';
                    templates.forEach(template => {
                        const option = document.createElement('option');
                        option.value = template.value;
                        option.textContent = template.label;
                        selectElement.appendChild(option);
                    });
                    selectElement.addEventListener('change', () => insertScriptTemplate(selectId, textareaId));
                }
            }
        }

        // ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æœ‰åŠ¹ç„¡åŠ¹åˆ‡ã‚Šæ›¿ãˆï¼ˆæ±ç”¨ï¼‰
        function toggleSection(checkboxId, containerId) {
            const checkbox = document.getElementById(checkboxId);
            const container = document.getElementById(containerId);
            if (!checkbox || !container) return;

            const enabled = checkbox.checked;

            if (enabled) {
                container.style.opacity = '1';
                container.style.pointerEvents = 'auto';
                const inputs = container.querySelectorAll('input, select, textarea');
                inputs.forEach(input => input.disabled = false);
                if (container.tagName === 'DETAILS' && !container.open) {
                    container.open = true;
                }
            } else {
                container.style.opacity = '0.5';
                container.style.pointerEvents = 'none';
                const inputs = container.querySelectorAll('input, select, textarea');
                inputs.forEach(input => input.disabled = true);
                if (container.tagName === 'DETAILS' && container.open) {
                    container.open = false;
                }
            }
        }

        // ã‚²ãƒ¼ãƒ ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‹ã‚‰_customDataã‚’å–å¾—
        function getGameCustomData() {
            if (!gameWindow || gameWindow.closed) {
                return null;
            }
            try {
                if (gameWindow.SceneManager &&
                    gameWindow.SceneManager._scene &&
                    gameWindow.SceneManager._scene._customData) {
                    return gameWindow.SceneManager._scene._customData;
                }
            } catch (error) {
                console.error('Error accessing game data:', error);
            }
            return null;
        }

        // ã‚²ãƒ¼ãƒ ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã‚’é€šçŸ¥
        function notifyGameDataChange(changedData) {
            if (!gameWindow || gameWindow.closed) {
                showNotification('ã‚²ãƒ¼ãƒ æ¥ç¶šã‚¨ãƒ©ãƒ¼', 'error');
                return false;
            }
            try {
                if (gameWindow.CustomMenuEditor) {
                    gameWindow.CustomMenuEditor.updateCustomData(changedData);
                    return true;
                }
            } catch (error) {
                console.error('Error notifying game:', error);
            }
            return false;
        }

        // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ï¼ˆPluginParamå¯¾ç­–ï¼‰
        function getParams(obj) {
            return (obj && obj._parameter) ? obj._parameter : obj;
        }

        // ãƒ•ã‚©ãƒ¼ãƒ ã«ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰
        function loadFormData() {
            const data = currentCustomData;
            if (!data) return;

            document.getElementById('sceneId').value = data.Id || '';
            document.getElementById('useHelp').value = data.UseHelp || '0';
            document.getElementById('helpRows').value = data.HelpRows || '';
            document.getElementById('picturePriority').value = data.PicturePriority || '0';
            document.getElementById('parallelEventId').value = data.ParallelEventId || '';
            document.getElementById('usePageButtons').checked = data.UsePageButtons === true || data.UsePageButtons === 'true';
            document.getElementById('snapNoFilter').checked = data.SnapNoFilter === true || data.SnapNoFilter === 'true';

            // InitialEvent
            const initialEvent = data.InitialEvent || {};
            const hasInitialEvent = Object.keys(getParams(initialEvent)).length > 0;
            document.getElementById('sceneInitialEventEnabled').checked = hasInitialEvent;
            document.getElementById('sceneInitialCommandId').value = initialEvent.CommandId || 0;
            document.getElementById('sceneInitialFocusWindowId').value = initialEvent.FocusWindowId || '';
            document.getElementById('sceneInitialFocusWindowIndex').value = initialEvent.FocusWindowIndex !== undefined ? initialEvent.FocusWindowIndex : -1;
            document.getElementById('sceneInitialSwitchId').value = initialEvent.SwitchId || 0;
            document.getElementById('sceneInitialScript').value = initialEvent.Script || '';
            document.getElementById('sceneInitialDeselect').checked = initialEvent.Deselect === true || initialEvent.Deselect === 'true';

            toggleSection('sceneInitialEventEnabled', 'sceneInitialEventDetails');

            // ActorChangeEvent
            const actorChangeEvent = data.ActorChangeEvent || {};
            const hasActorChangeEvent = Object.keys(getParams(actorChangeEvent)).length > 0;
            document.getElementById('sceneActorChangeEventEnabled').checked = hasActorChangeEvent;
            document.getElementById('sceneActorChangeCommandId').value = actorChangeEvent.CommandId || 0;
            document.getElementById('sceneActorChangeFocusWindowId').value = actorChangeEvent.FocusWindowId || '';
            document.getElementById('sceneActorChangeFocusWindowIndex').value = actorChangeEvent.FocusWindowIndex !== undefined ? actorChangeEvent.FocusWindowIndex : -1;
            document.getElementById('sceneActorChangeSwitchId').value = actorChangeEvent.SwitchId || 0;
            document.getElementById('sceneActorChangeScript').value = actorChangeEvent.Script || '';
            document.getElementById('sceneActorChangeDeselect').checked = actorChangeEvent.Deselect === true || actorChangeEvent.Deselect === 'true';

            toggleSection('sceneActorChangeEventEnabled', 'sceneActorChangeEventDetails');

            // Panorama
            const panorama = data.Panorama || {};
            const hasPanorama = Object.keys(getParams(panorama)).length > 0 && !!panorama.Image;
            document.getElementById('scenePanoramaEnabled').checked = hasPanorama;
            document.getElementById('scenePanoramaImage').value = panorama.Image || '';
            document.getElementById('scenePanoramaScrollX').value = panorama.ScrollX || 0;
            document.getElementById('scenePanoramaScrollY').value = panorama.ScrollY || 0;

            toggleSection('scenePanoramaEnabled', 'scenePanoramaDetails');
        }

        // ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        function getFormData() {
            return {
                Id: document.getElementById('sceneId').value,
                UseHelp: document.getElementById('useHelp').value,
                HelpRows: parseInt(document.getElementById('helpRows').value) || 0,
                PicturePriority: document.getElementById('picturePriority').value,
                ParallelEventId: parseInt(document.getElementById('parallelEventId').value) || 0,
                UsePageButtons: document.getElementById('usePageButtons').checked,
                SnapNoFilter: document.getElementById('snapNoFilter').checked,
                InitialEvent: document.getElementById('sceneInitialEventEnabled').checked ? {
                    CommandId: parseInt(document.getElementById('sceneInitialCommandId').value) || 0,
                    FocusWindowId: document.getElementById('sceneInitialFocusWindowId').value || undefined,
                    FocusWindowIndex: parseInt(document.getElementById('sceneInitialFocusWindowIndex').value) || -1,
                    SwitchId: parseInt(document.getElementById('sceneInitialSwitchId').value) || 0,
                    Script: document.getElementById('sceneInitialScript').value || '',
                    Deselect: document.getElementById('sceneInitialDeselect').checked
                } : "",
                ActorChangeEvent: document.getElementById('sceneActorChangeEventEnabled').checked ? {
                    CommandId: parseInt(document.getElementById('sceneActorChangeCommandId').value) || 0,
                    FocusWindowId: document.getElementById('sceneActorChangeFocusWindowId').value || undefined,
                    FocusWindowIndex: parseInt(document.getElementById('sceneActorChangeFocusWindowIndex').value) || -1,
                    SwitchId: parseInt(document.getElementById('sceneActorChangeSwitchId').value) || 0,
                    Script: document.getElementById('sceneActorChangeScript').value || '',
                    Deselect: document.getElementById('sceneActorChangeDeselect').checked
                } : "",
                Panorama: document.getElementById('scenePanoramaEnabled').checked ? {
                    Image: document.getElementById('scenePanoramaImage').value || '',
                    ScrollX: parseInt(document.getElementById('scenePanoramaScrollX').value) || 0,
                    ScrollY: parseInt(document.getElementById('scenePanoramaScrollY').value) || 0
                } : ""
            };
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚¹ãƒˆã‚’æ›´æ–°
        function updateWindowSelector() {
            const selector = document.getElementById('windowSelector');
            selector.innerHTML = '<option value="">-- ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é¸æŠ --</option>';

            // Update Scene Initial Event Focus Window Selector
            const sceneInitialSelector = document.getElementById('sceneInitialFocusWindowId');
            const savedSceneInitialValue = sceneInitialSelector ? sceneInitialSelector.value : '';
            if (sceneInitialSelector) {
                sceneInitialSelector.innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';
            }

            // Update Scene Actor Change Event Focus Window Selector
            const sceneActorChangeSelector = document.getElementById('sceneActorChangeFocusWindowId');
            const savedSceneActorChangeValue = sceneActorChangeSelector ? sceneActorChangeSelector.value : '';
            if (sceneActorChangeSelector) {
                sceneActorChangeSelector.innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';
            }

            if (currentCustomData && currentCustomData.WindowList) {
                currentCustomData.WindowList.forEach((win, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = win.Id || `Window ${index + 1}`;
                    selector.appendChild(option);

                    // Scene Initial Event selector
                    if (sceneInitialSelector) {
                        const optionInit = document.createElement('option');
                        optionInit.value = win.Id;
                        optionInit.textContent = win.Id || '(æœªå‘½å)';
                        sceneInitialSelector.appendChild(optionInit);
                    }

                    // Scene Actor Change Event selector
                    if (sceneActorChangeSelector) {
                        const optionActorChange = document.createElement('option');
                        optionActorChange.value = win.Id;
                        optionActorChange.textContent = win.Id || '(æœªå‘½å)';
                        sceneActorChangeSelector.appendChild(optionActorChange);
                    }
                });
            }

            if (sceneInitialSelector) {
                sceneInitialSelector.value = savedSceneInitialValue;
            }
            if (sceneActorChangeSelector) {
                sceneActorChangeSelector.value = savedSceneActorChangeValue;
            }
        }

        // ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã‚’é–‹ã
        function openWizard() {
            if (!currentCustomData || !currentCustomData.WindowList) {
                showNotification('ã‚·ãƒ¼ãƒ³æƒ…å ±ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„', 'error');
                return;
            }

            wizardStep = 0;
            wizardData = {
                Id: '',
                Type: 'command',
                ListScript: '',
                ListWindowId: '',
                x: 0, y: 0, width: 0, height: 0,
                RelativeWindowIdX: '', RelativeWindowIdY: '',
                HiddenNoFocus: false, DarkNoFocus: false
            };

            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆIDç”Ÿæˆ
            let counter = 1;
            while (currentCustomData.WindowList.some(w => w.Id === `window${counter}`)) {
                counter++;
            }
            wizardData.Id = `window${counter}`;

            renderWizardStep();
            document.getElementById('wizardModal').classList.add('active');
        }

        // ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã‚’é–‰ã˜ã‚‹
        function closeWizardModal() {
            document.getElementById('wizardModal').classList.remove('active');
        }

        // ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã®ã‚¹ãƒ†ãƒƒãƒ—æç”»
        function renderWizardStep() {
            const questionEl = document.getElementById('wizardQuestion');
            const inputsEl = document.getElementById('wizardInputs');
            const backBtn = document.getElementById('wizardBackBtn');
            const nextBtn = document.getElementById('wizardNextBtn');

            inputsEl.innerHTML = '';
            backBtn.disabled = (wizardStep === 0);
            nextBtn.textContent = (wizardStep === 5) ? 'å®Œäº†' : 'æ¬¡ã¸';

            switch (wizardStep) {
                case 0: // ID
                    questionEl.textContent = 'æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åå‰(ID)ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                    const idInput = document.createElement('input');
                    idInput.type = 'text';
                    idInput.className = 'form-input';
                    idInput.value = wizardData.Id;
                    idInput.id = 'wizardInputId';
                    inputsEl.appendChild(idInput);
                    break;
                case 1: // Type
                    questionEl.textContent = 'ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚';
                    const typeSelect = document.createElement('select');
                    typeSelect.className = 'form-select';
                    typeSelect.id = 'wizardInputType';
                    typeSelect.innerHTML = `
                        <option value="command">ã‚³ãƒãƒ³ãƒ‰ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (ã€Œã¯ã„/ã„ã„ãˆã€ãªã©ã®å›ºå®šé¸æŠè‚¢)</option>
                        <option value="list">ãƒ‡ãƒ¼ã‚¿ãƒªã‚¹ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (ã‚¢ã‚¤ãƒ†ãƒ ã€ã‚¹ã‚­ãƒ«ã€ã‚¢ã‚¯ã‚¿ãƒ¼ä¸€è¦§ãªã©)</option>
                        <option value="detail">è©³ç´°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ (ä»–ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é¸æŠä¸­ã®é …ç›®ã®è©³ç´°è¡¨ç¤º)</option>
                    `;
                    typeSelect.value = wizardData.Type;
                    inputsEl.appendChild(typeSelect);
                    break;
                case 2: // Content details
                    if (wizardData.Type === 'command') {
                        questionEl.textContent = 'ã‚³ãƒãƒ³ãƒ‰ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¨­å®šã§ã™ã€‚';
                        const info = document.createElement('p');
                        info.textContent = 'ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã®è¨­å®šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å¾Œã§é¸æŠè‚¢ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚';
                        info.style.color = '#888';
                        inputsEl.appendChild(info);
                    } else if (wizardData.Type === 'list') {
                        questionEl.textContent = 'è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ä¸€è¦§ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚';
                        const scriptSelect = document.createElement('select');
                        scriptSelect.className = 'form-select';
                        scriptSelect.id = 'wizardInputListScript';
                        LIST_SCRIPT_TEMPLATES.forEach(t => {
                            if (t.value) {
                                const opt = document.createElement('option');
                                opt.value = t.value;
                                opt.textContent = t.label;
                                scriptSelect.appendChild(opt);
                            }
                        });
                        scriptSelect.value = wizardData.ListScript || LIST_SCRIPT_TEMPLATES[1].value;
                        inputsEl.appendChild(scriptSelect);
                    } else if (wizardData.Type === 'detail') {
                        questionEl.textContent = 'å¯¾è±¡ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¨è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚';
                        const winSelect = document.createElement('select');
                        winSelect.className = 'form-select';
                        winSelect.id = 'wizardInputListWindowId';
                        let hasOptions = false;
                        currentCustomData.WindowList.forEach(w => {
                            const opt = document.createElement('option');
                            opt.value = w.Id;
                            opt.textContent = w.Id;
                            winSelect.appendChild(opt);
                            hasOptions = true;
                        });
                        if (!hasOptions) {
                            const opt = document.createElement('option');
                            opt.value = "";
                            opt.textContent = "(å¯¾è±¡ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãªã—)";
                            winSelect.appendChild(opt);
                        }
                        winSelect.value = wizardData.ListWindowId;
                        inputsEl.appendChild(winSelect);

                        const drawScriptLabel = document.createElement('label');
                        drawScriptLabel.className = 'form-label';
                        drawScriptLabel.textContent = 'è¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ï¼ˆä»»æ„ï¼‰';
                        drawScriptLabel.style.marginTop = '10px';
                        inputsEl.appendChild(drawScriptLabel);

                        const drawScriptSelect = document.createElement('select');
                        drawScriptSelect.className = 'form-select';
                        drawScriptSelect.id = 'wizardInputItemDrawScript';
                        ITEM_DRAW_SCRIPT_TEMPLATES.forEach(t => {
                            const opt = document.createElement('option');
                            opt.value = t.value;
                            opt.textContent = t.label;
                            drawScriptSelect.appendChild(opt);
                        });
                        inputsEl.appendChild(drawScriptSelect);
                    }
                    break;
                case 3: // Layout
                    questionEl.textContent = 'é…ç½®ã¨ã‚µã‚¤ã‚ºã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚';
                    const layoutDiv = document.createElement('div');
                    layoutDiv.className = 'form-row';
                    layoutDiv.innerHTML = `
                        <div class="form-group">
                            <label class="form-label">Xåº§æ¨™</label>
                            <input type="number" id="wizardInputX" class="form-input" value="${wizardData.x}">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Yåº§æ¨™</label>
                            <input type="number" id="wizardInputY" class="form-input" value="${wizardData.y}">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ç›¸å¯¾Xåº§æ¨™ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦</label>
                            <select id="wizardInputRelativeX" class="form-select">
                                <option value="">(ãªã—)</option>
                                ${currentCustomData.WindowList.map(w => `<option value="${w.Id}" ${w.Id === wizardData.RelativeWindowIdX ? 'selected' : ''}>${w.Id}</option>`).join('')}
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ç›¸å¯¾Yåº§æ¨™ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦</label>
                            <select id="wizardInputRelativeY" class="form-select">
                                <option value="">(ãªã—)</option>
                                ${currentCustomData.WindowList.map(w => `<option value="${w.Id}" ${w.Id === wizardData.RelativeWindowIdY ? 'selected' : ''}>${w.Id}</option>`).join('')}
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å¹… (0ã§è‡ªå‹•)</label>
                            <input type="number" id="wizardInputW" class="form-input" value="${wizardData.width}">
                        </div>
                        <div class="form-group">
                            <label class="form-label">é«˜ã• (0ã§è‡ªå‹•)</label>
                            <input type="number" id="wizardInputH" class="form-input" value="${wizardData.height}">
                        </div>
                    `;
                    inputsEl.appendChild(layoutDiv);
                    break;
                case 4: // Focus behavior
                    questionEl.textContent = 'ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®æŒ™å‹•ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚';
                    const focusDiv = document.createElement('div');
                    focusDiv.innerHTML = `
                        <div class="form-group">
                            <label class="form-label">éãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã¯éš ã™</label>
                            <input type="checkbox" id="wizardInputHiddenNoFocus" ${wizardData.HiddenNoFocus ? 'checked' : ''}>
                        </div>
                        <div class="form-group">
                            <label class="form-label">éãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã¯æš—è»¢</label>
                            <input type="checkbox" id="wizardInputDarkNoFocus" ${wizardData.DarkNoFocus ? 'checked' : ''}>
                        </div>
                    `;
                    inputsEl.appendChild(focusDiv);
                    break;
                case 5: // Completion Guide
                    questionEl.textContent = 'è¨­å®šãŒå®Œäº†ã—ã¾ã—ãŸã€‚ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½œæˆã—ã¾ã™ã€‚';
                    const guideDiv = document.createElement('div');
                    guideDiv.style.padding = '15px';
                    guideDiv.style.background = '#2d2d30';
                    guideDiv.style.borderRadius = '4px';
                    guideDiv.style.borderLeft = '4px solid #4ec9b0';

                    let guideText = '';
                    if (wizardData.Type === 'command') {
                        guideText = 'ã‚³ãƒãƒ³ãƒ‰ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½œæˆã—ã¾ã™ã€‚<br>ä½œæˆå¾Œã€ã€Œã‚³ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰é¸æŠè‚¢ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚';
                    } else if (wizardData.Type === 'list') {
                        guideText = 'ãƒ‡ãƒ¼ã‚¿ãƒªã‚¹ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½œæˆã—ã¾ã™ã€‚<br>ä½œæˆå¾Œã¯ã€Œæ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆã€ã‹ã‚‰æ±ºå®šæ™‚ã®å‹•ä½œè¨­å®šãŒã§ãã¾ã™ã€‚';
                    } else if (wizardData.Type === 'detail') {
                        guideText = 'è©³ç´°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½œæˆã—ã¾ã™ã€‚<br>è¡¨ç¤ºå†…å®¹ã¯ã€Œé …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚';
                    }
                    guideDiv.innerHTML = `<p style="color: #e0e0e0; line-height: 1.5;">${guideText}</p>`;
                    inputsEl.appendChild(guideDiv);
                    break;
            }
        }

        // ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ï¼šæ¬¡ã¸
        function wizardNext() {
            if (!saveWizardStepData()) return;

            if (wizardStep < 5) {
                wizardStep++;
                renderWizardStep();
            } else {
                finishWizard();
            }
        }

        // ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ï¼šæˆ»ã‚‹
        function wizardBack() {
            if (wizardStep > 0) {
                wizardStep--;
                renderWizardStep();
            }
        }

        // ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
        function saveWizardStepData() {
            switch (wizardStep) {
                case 0:
                    const id = document.getElementById('wizardInputId').value.trim();
                    if (!id) {
                        showNotification('è­˜åˆ¥å­ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                        return false;
                    }
                    if (currentCustomData.WindowList.some(w => w.Id === id)) {
                        showNotification('ãã®è­˜åˆ¥å­ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™', 'error');
                        return false;
                    }
                    wizardData.Id = id;
                    break;
                case 1:
                    wizardData.Type = document.getElementById('wizardInputType').value;
                    break;
                case 2:
                    if (wizardData.Type === 'list') {
                        wizardData.ListScript = document.getElementById('wizardInputListScript').value;
                    } else if (wizardData.Type === 'detail') {
                        wizardData.ListWindowId = document.getElementById('wizardInputListWindowId').value;
                        wizardData.ItemDrawScript = document.getElementById('wizardInputItemDrawScript').value;
                    }
                    break;
                case 3:
                    wizardData.x = parseInt(document.getElementById('wizardInputX').value) || 0;
                    wizardData.y = parseInt(document.getElementById('wizardInputY').value) || 0;
                    wizardData.RelativeWindowIdX = document.getElementById('wizardInputRelativeX').value;
                    wizardData.RelativeWindowIdY = document.getElementById('wizardInputRelativeY').value;
                    wizardData.width = parseInt(document.getElementById('wizardInputW').value) || 0;
                    wizardData.height = parseInt(document.getElementById('wizardInputH').value) || 0;
                    break;
                case 4:
                    wizardData.HiddenNoFocus = document.getElementById('wizardInputHiddenNoFocus').checked;
                    wizardData.DarkNoFocus = document.getElementById('wizardInputDarkNoFocus').checked;
                    break;
            }
            return true;
        }

        // ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å®Œäº†ï¼šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ä½œæˆ
        function finishWizard() {
            const newWindow = {
                Id: wizardData.Id,
                x: wizardData.x,
                y: wizardData.y,
                width: wizardData.width,
                height: wizardData.height,
                ColumnNumber: 1,
                RowNumber: 0,
                RelativeWindowIdX: wizardData.RelativeWindowIdX,
                RelativeWindowIdY: wizardData.RelativeWindowIdY,
                originX: 0,
                Rotation: 0,
                ItemHeight: 0,
                CommandList: '',
                DataScript: '',
                ListWindowId: '',
                ListScript: '',
                FilterScript: '',
                MappingScript: '',
                SortScript: '',
                ItemDrawScript: [],
                ItemDrawMultiLineScript: '',
                IsEnableScript: '',
                CommonHelpText: '',
                DecisionEvent: {},
                CancelEvent: {},
                CursorEvent: {},
                ButtonEvent: [],
                FontSize: 0,
                FontFace: '',
                OverlapOther: false,
                WindowSkin: '',
                VisibleSwitchId: 0,
                ShowOpenAnimation: true,
                RefreshSwitchId: 0,
                IndexVariableId: 0,
                RememberIndex: false,
                ItemVariableId: 0,
                Cancelable: true,
                PopCancel: true,
                ActorChangeable: false,
                HiddenNoFocus: wizardData.HiddenNoFocus,
                DarkNoFocus: wizardData.DarkNoFocus,
                MaskingText: '',
                okSound: '',
                cursorOverContents: false,
                noItemBackground: false,
                noFrame: false,
                textColor: 0,
                cursorAllSwitchId: 0,
                cursorFixedSwitchId: 0
            };

            if (wizardData.Type === 'list') {
                newWindow.ListScript = wizardData.ListScript;
            } else if (wizardData.Type === 'detail') {
                newWindow.ListWindowId = wizardData.ListWindowId;
                if (wizardData.ItemDrawScript) {
                    newWindow.ItemDrawScript = [wizardData.ItemDrawScript];
                }
            } else if (wizardData.Type === 'command') {
                newWindow.CommandList = [];
            }

            const newWindowData = new PluginParam(newWindow, false);
            currentCustomData.WindowList.push(newWindowData);

            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification(`ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ '${newWindow.Id}' ã‚’è¿½åŠ ã—ã¾ã—ãŸ`, 'success');
                updateWindowSelector();
                const selector = document.getElementById('windowSelector');
                selector.value = currentCustomData.WindowList.length - 1;
                selectWindow();
                closeWizardModal();
            } else {
                showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                currentCustomData.WindowList.pop();
            }
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿½åŠ 
        function addWindow() {
            if (!currentCustomData || !currentCustomData.WindowList) {
                showNotification('ã‚·ãƒ¼ãƒ³æƒ…å ±ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„', 'error');
                return;
            }

            // æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦IDã‚’ç”Ÿæˆ
            let defaultId = 'window1';
            let counter = 1;
            while (currentCustomData.WindowList.some(w => w.Id === defaultId)) {
                counter++;
                defaultId = `window${counter}`;
            }

            const inputId = prompt('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', defaultId);
            if (inputId === null) return; // ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            const newId = inputId.trim();
            if (!newId) {
                showNotification('è­˜åˆ¥å­ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            if (currentCustomData.WindowList.some(w => w.Id === newId)) {
                showNotification('ãã®è­˜åˆ¥å­ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™', 'error');
                return;
            }

            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ§‹é€ ã‚’ä½œæˆ
            const newWindow = {
                Id: newId,
                x: 0,
                RelativeWindowIdX: '',
                y: 0,
                RelativeWindowIdY: '',
                width: 0,
                height: 0,
                originX: 0,
                ColumnNumber: 1,
                RowNumber: 0,
                Rotation: 0,
                ItemHeight: 0,
                CommandList: '',
                DataScript: '',
                ListWindowId: '',
                ListScript: '',
                FilterScript: '',
                MappingScript: '',
                SortScript: '',
                ItemDrawScript: [],
                ItemDrawMultiLineScript: '',
                IsEnableScript: '',
                CommonHelpText: '',
                DecisionEvent: {},
                CancelEvent: {},
                CursorEvent: {},
                ButtonEvent: [],
                FontSize: 0,
                FontFace: '',
                OverlapOther: false,
                WindowSkin: '',
                VisibleSwitchId: 0,
                ShowOpenAnimation: true,
                RefreshSwitchId: 0,
                IndexVariableId: 0,
                RememberIndex: false,
                ItemVariableId: 0,
                Cancelable: true,
                PopCancel: true,
                ActorChangeable: false,
                HiddenNoFocus: false,
                DarkNoFocus: false,
                MaskingText: '',
                okSound: '',
                cursorOverContents: false,
                noItemBackground: false,
                noFrame: false,
                textColor: 0,
                cursorAllSwitchId: 0,
                cursorFixedSwitchId: 0
            };

            const newWindowData = new PluginParam(newWindow, false);
            currentCustomData.WindowList.push(newWindowData);
            //currentCustomData.WindowList.push(newWindow);

            // ã‚²ãƒ¼ãƒ ã«å¤‰æ›´ã‚’é€šçŸ¥
            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification(`ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ '${newId}' ã‚’è¿½åŠ ã—ã¾ã—ãŸ`, 'success');
                updateWindowSelector();
                // æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é¸æŠ
                const selector = document.getElementById('windowSelector');
                selector.value = Math.max(0, currentCustomData.WindowList.length - 1);
                selectWindow();
            } else {
                showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                currentCustomData.WindowList.pop();
            }
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’å‰Šé™¤
        function deleteWindow() {
            const selector = document.getElementById('windowSelector');
            const index = parseInt(selector.value);

            if (isNaN(index)) {
                showNotification('å‰Šé™¤ã™ã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const windowId = currentCustomData.WindowList[index].Id;
            if (!confirm(`ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ '${windowId}' ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`)) {
                return;
            }

            currentCustomData.WindowList.splice(index, 1);

            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification(`ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ '${windowId}' ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`, 'success');
                updateWindowSelector();
                document.getElementById('windowEditorContainer').style.display = 'none';
                selector.value = '';
            } else {
                showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                // å‰Šé™¤ã‚’ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
                currentCustomData.WindowList.splice(index, 0, {});
            }
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é¸æŠ
        function selectWindow() {
            const selector = document.getElementById('windowSelector');
            const index = parseInt(selector.value);

            if (isNaN(index)) {
                document.getElementById('windowEditorContainer').style.display = 'none';
                document.getElementById('windowButtonGroup').style.display = 'none';
                return;
            }

            const window = currentCustomData.WindowList[index];
            if (!window) return;

            // ç›¸å¯¾åº§æ¨™ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’å‹•çš„ã«ç”Ÿæˆ
            updateRelativeWindowSelectors(index);

            // ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ­ãƒ¼ãƒ‰
            document.getElementById('windowId').value = window.Id || '';
            // åº§æ¨™ãƒ»ã‚µã‚¤ã‚º
            document.getElementById('windowX').value = window.x || 0;
            document.getElementById('windowY').value = window.y || 0;
            document.getElementById('windowRelativeWindowIdX').value = window.RelativeWindowIdX || '';
            document.getElementById('windowRelativeWindowIdY').value = window.RelativeWindowIdY || '';
            document.getElementById('windowWidth').value = window.width || 0;
            document.getElementById('windowHeight').value = window.height || 0;
            document.getElementById('windowColumns').value = window.ColumnNumber || 1;
            document.getElementById('windowRows').value = window.RowNumber || 0;
            document.getElementById('windowOriginX').value = window.originX || 0;
            document.getElementById('windowRotation').value = window.Rotation || 0;
            document.getElementById('windowItemHeight').value = window.ItemHeight || 0;
            // è¡¨ç¤ºãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³
            document.getElementById('windowFontSize').value = window.FontSize || 0;
            document.getElementById('windowFontFace').value = window.FontFace || '';
            document.getElementById('windowTextColor').value = window.textColor || 0;
            document.getElementById('windowNoItemBackground').checked = window.noItemBackground === true || window.noItemBackground === 'true';
            // å‹•ä½œãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            const okSound = window.okSound || {};
            const hasOkSound = !!okSound && typeof okSound === 'object' && !!okSound.name;
            document.getElementById('windowOkSoundEnabled').checked = hasOkSound;

            document.getElementById('windowOkSoundName').value = okSound.name || '';
            document.getElementById('windowOkSoundVolume').value = okSound.volume !== undefined ? okSound.volume : 90;
            document.getElementById('windowOkSoundPitch').value = okSound.pitch !== undefined ? okSound.pitch : 100;
            document.getElementById('windowOkSoundPan').value = okSound.pan !== undefined ? okSound.pan : 0;

            toggleSection('windowOkSoundEnabled', 'windowOkSoundContainer');

            document.getElementById('windowCancelable').checked = window.Cancelable !== false;
            document.getElementById('windowPopCancel').checked = window.PopCancel !== false;
            document.getElementById('windowActorChangeable').checked = window.ActorChangeable === true || window.ActorChangeable === 'true';
            document.getElementById('windowShowOpenAnimation').checked = window.ShowOpenAnimation !== false;
            document.getElementById('windowCursorOverContents').checked = window.cursorOverContents === true || window.cursorOverContents === 'true';
            document.getElementById('windowNoFrame').checked = window.noFrame === true || window.noFrame === 'true';
            document.getElementById('windowHiddenNoFocus').checked = window.HiddenNoFocus === true || window.HiddenNoFocus === 'true';
            document.getElementById('windowDarkNoFocus').checked = window.DarkNoFocus === true || window.DarkNoFocus === 'true';
            document.getElementById('windowOverlapOther').checked = window.OverlapOther === true || window.OverlapOther === 'true';
            // ãƒ‡ãƒ¼ã‚¿ãƒ»å¤‰æ•°
            document.getElementById('windowVisibleSwitchId').value = window.VisibleSwitchId || 0;
            document.getElementById('windowRefreshSwitchId').value = window.RefreshSwitchId || 0;
            document.getElementById('windowIndexVariableId').value = window.IndexVariableId || 0;
            document.getElementById('windowRememberIndex').checked = window.RememberIndex === true || window.RememberIndex === 'true';
            document.getElementById('windowItemVariableId').value = window.ItemVariableId || 0;
            document.getElementById('windowCursorAllSwitchId').value = window.cursorAllSwitchId || 0;
            document.getElementById('windowMaskingText').value = window.MaskingText || '';

            // ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
            document.getElementById('windowListWindowId').value = window.ListWindowId || '';
            document.getElementById('windowListScript').value = window.ListScript || '';
            document.getElementById('windowFilterScript').value = window.FilterScript || '';
            document.getElementById('windowMappingScript').value = window.MappingScript || '';
            document.getElementById('windowSortScript').value = window.SortScript || '';
            document.getElementById('windowIsEnableScript').value = window.IsEnableScript || '';
            document.getElementById('windowCommonHelpText').value = window.CommonHelpText || '';
            document.getElementById('windowItemDrawMultiLineScript').value = window.ItemDrawMultiLineScript || '';

            // ã‚¤ãƒ™ãƒ³ãƒˆ
            const decisionEvent = window.DecisionEvent || {};
            const cancelEvent = window.CancelEvent || {};
            const cursorEvent = window.CursorEvent || {};

            // ã‚¤ãƒ™ãƒ³ãƒˆã®æœ‰åŠ¹çŠ¶æ…‹ã‚’åˆ¤å®š
            const hasDecisionEvent = Object.keys(getParams(decisionEvent)).length > 0;
            const hasCancelEvent = Object.keys(getParams(cancelEvent)).length > 0;
            const hasCursorEvent = Object.keys(getParams(cursorEvent)).length > 0;

            document.getElementById('decisionEventEnabled').checked = hasDecisionEvent;
            document.getElementById('cancelEventEnabled').checked = hasCancelEvent;
            document.getElementById('cursorEventEnabled').checked = hasCursorEvent;

            // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦IDãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’æ›´æ–°
            updateEventFocusWindowSelectors();

            // æ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆ
            document.getElementById('decisionCommandId').value = decisionEvent.CommandId || 0;
            document.getElementById('decisionFocusWindowId').value = decisionEvent.FocusWindowId || '';
            document.getElementById('decisionFocusWindowIndex').value = decisionEvent.FocusWindowIndex !== undefined ? decisionEvent.FocusWindowIndex : -1;
            document.getElementById('decisionSwitchId').value = decisionEvent.SwitchId || 0;
            document.getElementById('decisionScript').value = decisionEvent.Script || '';
            document.getElementById('decisionDeselect').checked = decisionEvent.Deselect === true || decisionEvent.Deselect === 'true';

            toggleSection('decisionEventEnabled', 'decisionEventDetails');

            // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ
            document.getElementById('cancelCommandId').value = cancelEvent.CommandId || 0;
            document.getElementById('cancelFocusWindowId').value = cancelEvent.FocusWindowId || '';
            document.getElementById('cancelFocusWindowIndex').value = cancelEvent.FocusWindowIndex !== undefined ? cancelEvent.FocusWindowIndex : -1;
            document.getElementById('cancelSwitchId').value = cancelEvent.SwitchId || 0;
            document.getElementById('cancelScript').value = cancelEvent.Script || '';
            document.getElementById('cancelDeselect').checked = cancelEvent.Deselect === true || cancelEvent.Deselect === 'true';

            toggleSection('cancelEventEnabled', 'cancelEventDetails');

            // ã‚«ãƒ¼ã‚½ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ
            document.getElementById('cursorCommandId').value = cursorEvent.CommandId || 0;
            document.getElementById('cursorFocusWindowId').value = cursorEvent.FocusWindowId || '';
            document.getElementById('cursorFocusWindowIndex').value = cursorEvent.FocusWindowIndex !== undefined ? cursorEvent.FocusWindowIndex : -1;
            document.getElementById('cursorSwitchId').value = cursorEvent.SwitchId || 0;
            document.getElementById('cursorScript').value = cursorEvent.Script || '';
            document.getElementById('cursorDeselect').checked = cursorEvent.Deselect === true || cursorEvent.Deselect === 'true';

            toggleSection('cursorEventEnabled', 'cursorEventDetails');

            // ç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä¿å­˜
            document.getElementById('windowEditorContainer').dataset.windowIndex = index;
            document.getElementById('windowEditorContainer').style.display = 'block';
            document.getElementById('windowButtonGroup').style.display = 'flex';

            // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
            refreshButtonEventList();

            // é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
            refreshItemDrawScriptList();

            // ã‚³ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
            refreshCommandListTable();

        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºãƒ»æ›´æ–°
        function refreshButtonEventList() {
            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);

            if (isNaN(windowIndex) || !currentCustomData.WindowList[windowIndex]) {
                return;
            }

            const window = currentCustomData.WindowList[windowIndex];
            const buttonEventList = window.ButtonEvent || [];
            const tbody = document.getElementById('buttonEventList');
            const table = document.getElementById('buttonEventTable');
            const noDataMsg = document.getElementById('noButtonEvents');

            tbody.innerHTML = '';

            if (buttonEventList.length === 0) {
                table.setAttribute('data-visible', 'false');
                noDataMsg.style.display = 'block';
            } else {
                table.setAttribute('data-visible', 'true');
                noDataMsg.style.display = 'none';

                buttonEventList.forEach((buttonEvent, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${buttonEvent.Name || '(æœªè¨­å®š)'}</td>
                        <td>${buttonEvent.Event && buttonEvent.Event.CommandId ? buttonEvent.Event.CommandId : '(ãªã—)'}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-edit" onclick="editButtonEvent(${index})">ç·¨é›†</button>
                                <button class="btn btn-delete" onclick="deleteButtonEvent(${index})">å‰Šé™¤</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ 
        function addButtonEvent() {
            currentButtonEventIndex = -1;
            document.getElementById('buttonEventModalTitle').textContent = 'ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ ';
            resetButtonEventForm();
            updateButtonEventFocusWindowSelector();
            document.getElementById('buttonEventModal').classList.add('active');
        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç·¨é›†
        function editButtonEvent(index) {
            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const window = currentCustomData.WindowList[windowIndex];
            const buttonEvent = window.ButtonEvent[index];

            if (!buttonEvent) return;

            currentButtonEventIndex = index;
            document.getElementById('buttonEventModalTitle').textContent = 'ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç·¨é›†';

            // ãƒ•ã‚©ãƒ¼ãƒ ã«å€¤ã‚’ãƒ­ãƒ¼ãƒ‰
            document.getElementById('buttonEventName').value = buttonEvent.Name || '';
            const event = buttonEvent.Event || {};
            document.getElementById('buttonEventCommandId').value = event.CommandId || 0;
            document.getElementById('buttonEventFocusWindowId').value = event.FocusWindowId || '';
            document.getElementById('buttonEventFocusWindowIndex').value = event.FocusWindowIndex !== undefined ? event.FocusWindowIndex : -1;
            document.getElementById('buttonEventSwitchId').value = event.SwitchId || 0;
            document.getElementById('buttonEventScript').value = event.Script || '';
            document.getElementById('buttonEventDeselect').checked = event.Deselect === true || event.Deselect === 'true';

            updateButtonEventFocusWindowSelector();
            document.getElementById('buttonEventModal').classList.add('active');
        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆå‰Šé™¤
        function deleteButtonEvent(index) {
            if (!confirm('ã“ã®ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                return;
            }

            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const window = currentCustomData.WindowList[windowIndex];

            window.ButtonEvent = window.ButtonEvent || [];
            window.ButtonEvent.splice(index, 1);

            refreshButtonEventList();
            showNotification('ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeButtonEventModal() {
            document.getElementById('buttonEventModal').classList.remove('active');
            resetButtonEventForm();
            currentButtonEventIndex = -1;
        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ä¿å­˜
        function saveButtonEventModal() {
            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const window = currentCustomData.WindowList[windowIndex];

            const name = document.getElementById('buttonEventName').value;
            if (!name) {
                showNotification('ãƒœã‚¿ãƒ³åã‚’é¸æŠã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const newButtonEvent = {
                Name: name,
                Event: {
                    CommandId: parseInt(document.getElementById('buttonEventCommandId').value) || 0,
                    FocusWindowId: document.getElementById('buttonEventFocusWindowId').value || undefined,
                    FocusWindowIndex: parseInt(document.getElementById('buttonEventFocusWindowIndex').value) || -1,
                    SwitchId: parseInt(document.getElementById('buttonEventSwitchId').value) || 0,
                    Script: document.getElementById('buttonEventScript').value || '',
                    Deselect: document.getElementById('buttonEventDeselect').checked
                }
            };

            window.ButtonEvent = window.ButtonEvent || [];

            if (currentButtonEventIndex >= 0) {
                // æ—¢å­˜ã®ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ›´æ–°
                window.ButtonEvent[currentButtonEventIndex] = newButtonEvent;
                showNotification('ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
            } else {
                // æ–°ã—ã„ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
                window.ButtonEvent.push(newButtonEvent);
                showNotification('ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¾ã—ãŸ', 'success');
            }

            refreshButtonEventList();
            closeButtonEventModal();
        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚»ãƒ¬ã‚¯ã‚¿ã‚’æ›´æ–°
        function updateButtonEventFocusWindowSelector() {
            const select = document.getElementById('buttonEventFocusWindowId');
            const savedValue = select.value;

            select.innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';

            if (currentCustomData && currentCustomData.WindowList) {
                currentCustomData.WindowList.forEach((win) => {
                    const option = document.createElement('option');
                    option.value = win.Id;
                    option.textContent = win.Id || '(æœªå‘½å)';
                    select.appendChild(option);
                });
            }

            select.value = savedValue;
        }

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetButtonEventForm() {
            document.getElementById('buttonEventName').value = '';
            document.getElementById('buttonEventCommandId').value = 0;
            document.getElementById('buttonEventFocusWindowId').value = '';
            document.getElementById('buttonEventFocusWindowIndex').value = -1;
            document.getElementById('buttonEventSwitchId').value = 0;
            document.getElementById('buttonEventScript').value = '';
            document.getElementById('buttonEventScriptTemplate').value = '';
            document.getElementById('buttonEventDeselect').checked = false;
        }

        // é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºãƒ»æ›´æ–°
        function refreshItemDrawScriptList() {
            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);

            if (isNaN(windowIndex) || !currentCustomData.WindowList[windowIndex]) {
                return;
            }

            const windowData = currentCustomData.WindowList[windowIndex];
            const scripts = Array.isArray(windowData.ItemDrawScript) ? windowData.ItemDrawScript :
                (windowData.ItemDrawScript ? [windowData.ItemDrawScript] : []);

            const tbody = document.getElementById('itemDrawScriptList');
            const table = document.getElementById('itemDrawScriptTable');
            const noDataMsg = document.getElementById('noItemDrawScripts');

            tbody.innerHTML = '';

            if (scripts.length === 0) {
                table.setAttribute('data-visible', 'false');
                noDataMsg.style.display = 'block';
            } else {
                table.setAttribute('data-visible', 'true');
                noDataMsg.style.display = 'none';

                scripts.forEach((script, index) => {
                    const row = document.createElement('tr');
                    const scriptPreview = script.length > 50 ? script.substring(0, 50) + '...' : script;
                    row.innerHTML = `
                        <td>${scriptPreview}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-edit" onclick="editItemDrawScript(${index})">ç·¨é›†</button>
                                <button class="btn btn-delete" onclick="deleteItemDrawScript(${index})">å‰Šé™¤</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ 
        function addItemDrawScript() {
            currentItemDrawScriptIndex = -1;
            document.getElementById('itemDrawScriptModalTitle').textContent = 'é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ ';
            document.getElementById('itemDrawScriptText').value = '';
            document.getElementById('itemDrawScriptTemplate').value = '';

            const modal = document.getElementById('itemDrawScriptModal');
            modal.classList.add('active');
        }

        // é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆç·¨é›†
        function editItemDrawScript(index) {
            currentItemDrawScriptIndex = index;
            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const windowData = currentCustomData.WindowList[windowIndex];
            const scripts = Array.isArray(windowData.ItemDrawScript) ? windowData.ItemDrawScript :
                (windowData.ItemDrawScript ? [windowData.ItemDrawScript] : []);

            if (scripts[index]) {
                document.getElementById('itemDrawScriptModalTitle').textContent = 'é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆç·¨é›†';
                document.getElementById('itemDrawScriptText').value = scripts[index];
                document.getElementById('itemDrawScriptTemplate').value = '';
                document.getElementById('itemDrawScriptModal').classList.add('active');
            }
        }

        // é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆå‰Šé™¤
        function deleteItemDrawScript(index) {
            if (!confirm('ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                return;
            }

            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const windowData = currentCustomData.WindowList[windowIndex];

            let scripts = Array.isArray(windowData.ItemDrawScript) ? windowData.ItemDrawScript :
                (windowData.ItemDrawScript ? [windowData.ItemDrawScript] : []);

            scripts.splice(index, 1);
            windowData.ItemDrawScript = scripts;

            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification('ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
                setTimeout(() => {
                    currentCustomData = getGameCustomData();
                    selectWindow();
                }, 500);
            }
        }

        // é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeItemDrawScriptModal() {
            document.getElementById('itemDrawScriptModal').classList.remove('active');
        }

        // é …ç›®æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ä¿å­˜
        function saveItemDrawScriptModal() {
            const scriptText = document.getElementById('itemDrawScriptText').value.trim();
            if (!scriptText) {
                showNotification('ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const windowData = currentCustomData.WindowList[windowIndex];

            let scripts = Array.isArray(windowData.ItemDrawScript) ? windowData.ItemDrawScript :
                (windowData.ItemDrawScript ? [windowData.ItemDrawScript] : []);

            if (currentItemDrawScriptIndex === -1) {
                // æ–°è¦è¿½åŠ 
                scripts.push(scriptText);
            } else {
                // æ—¢å­˜ç·¨é›†
                scripts[currentItemDrawScriptIndex] = scriptText;
            }

            windowData.ItemDrawScript = scripts;

            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification('ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
                closeItemDrawScriptModal();
                setTimeout(() => {
                    currentCustomData = getGameCustomData();
                    selectWindow();
                }, 500);
            } else {
                showNotification('ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        // ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŒ¿å…¥ï¼ˆæ±ç”¨é–¢æ•°ï¼‰
        function insertScriptTemplate(selectElementId, textareaElementId) {
            const selectElement = document.getElementById(selectElementId);
            const textareaElement = document.getElementById(textareaElementId);

            if (selectElement && textareaElement && selectElement.value) {
                // ç¾åœ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã®æœ«å°¾ã«æ”¹è¡ŒãŒã‚ã‚Œã°ã€ãªã‘ã‚Œã°æ”¹è¡Œã‚’è¿½åŠ 
                const currentText = textareaElement.value;
                const newLine = currentText && !currentText.endsWith('\n') ? '\n' : '';

                // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è¿½åŠ 
                textareaElement.value += newLine + selectElement.value;

                // ã‚»ãƒ¬ã‚¯ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
                selectElement.value = '';

                // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«è¨­å®š
                textareaElement.focus();
                // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä½ç½®ã‚’æœ«å°¾ã«è¨­å®š
                textareaElement.scrollTop = textareaElement.scrollHeight;
            }
        }

        // ã‚³ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¡¨ç¤ºãƒ»æ›´æ–°
        function refreshCommandListTable() {
            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);

            if (isNaN(windowIndex) || !currentCustomData.WindowList[windowIndex]) {
                return;
            }

            const windowData = currentCustomData.WindowList[windowIndex];
            const commandList = windowData.CommandList ? JSON.parse(JSON.stringify(windowData.CommandList)) : [];
            const tbody = document.getElementById('commandListItems');
            const table = document.getElementById('commandListTable');
            const noDataMsg = document.getElementById('noCommandListItems');

            tbody.innerHTML = '';

            if (commandList.length === 0) {
                table.setAttribute('data-visible', 'false');
                noDataMsg.style.display = 'block';
            } else {
                table.setAttribute('data-visible', 'true');
                noDataMsg.style.display = 'none';

                commandList.forEach((command, index) => {
                    const row = document.createElement('tr');
                    const helpPreview = command.HelpText ? (command.HelpText.length > 40 ? command.HelpText.substring(0, 40) + '...' : command.HelpText) : '(ãªã—)';
                    row.innerHTML = `
                        <td>${command.Text || '(æœªè¨­å®š)'}</td>
                        <td>${helpPreview}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-edit" onclick="editCommandList(${index})">ç·¨é›†</button>
                                <button class="btn btn-delete" onclick="deleteCommandList(${index})">å‰Šé™¤</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // ã‚³ãƒãƒ³ãƒ‰è¿½åŠ 
        function addCommandList() {
            currentCommandListIndex = -1;
            document.getElementById('commandListModalTitle').textContent = 'ã‚³ãƒãƒ³ãƒ‰è¿½åŠ ';
            resetCommandListForm();
            document.getElementById('commandListModal').classList.add('active');
        }

        // ã‚³ãƒãƒ³ãƒ‰ç·¨é›†
        function editCommandList(index) {
            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const windowData = currentCustomData.WindowList[windowIndex];
            const commandList = windowData.CommandList ? JSON.parse(JSON.stringify(windowData.CommandList)) : [];
            const command = commandList[index];

            if (!command) return;

            currentCommandListIndex = index;
            document.getElementById('commandListModalTitle').textContent = 'ã‚³ãƒãƒ³ãƒ‰ç·¨é›†';

            // ãƒ•ã‚©ãƒ¼ãƒ ã«å€¤ã‚’ãƒ­ãƒ¼ãƒ‰
            document.getElementById('commandListText').value = command.Text || '';
            document.getElementById('commandListHelpText').value = command.HelpText || '';
            document.getElementById('commandListVisibleSwitchId').value = command.VisibleSwitchId || 0;
            document.getElementById('commandListVisibleScript').value = command.VisibleScript || '';
            document.getElementById('commandListEnableSwitchId').value = command.EnableSwitchId || 0;
            document.getElementById('commandListCancelChoice').checked = command.CancelChoice === true || command.CancelChoice === 'true';
            document.getElementById('commandListAlign').value = command.Align !== undefined ? command.Align : 0;
            document.getElementById('commandListIsEnableScript').value = command.IsEnableScript || '';

            // DecisionEventæƒ…å ±ã‚’ãƒ­ãƒ¼ãƒ‰
            const decisionEvent = command.DecisionEvent;
            const hasDecisionEvent = !!decisionEvent && Object.keys(decisionEvent).length > 0;
            document.getElementById('commandListDecisionEventEnabled').checked = hasDecisionEvent;
            const d = decisionEvent || {};
            document.getElementById('commandListDecisionCommandId').value = d.CommandId || 0;
            updateCommandListDecisionFocusWindowSelector(d.FocusWindowId);
            document.getElementById('commandListDecisionFocusWindowIndex').value = d.FocusWindowIndex !== undefined ? d.FocusWindowIndex : -1;
            document.getElementById('commandListDecisionSwitchId').value = d.SwitchId || 0;
            document.getElementById('commandListDecisionScript').value = d.Script || '';
            document.getElementById('commandListDecisionDeselect').checked = d.Deselect === true || d.Deselect === 'true';

            toggleSection('commandListDecisionEventEnabled', 'commandListDecisionEventContainer');

            // OkSoundæƒ…å ±ã‚’ãƒ­ãƒ¼ãƒ‰
            const okSound = command.OkSound;
            const hasOkSound = !!okSound && typeof okSound === 'object' && !!okSound.name;
            document.getElementById('commandListOkSoundEnabled').checked = hasOkSound;

            if (hasOkSound) {
                document.getElementById('commandListOkSoundName').value = okSound.name || '';
                document.getElementById('commandListOkSoundVolume').value = okSound.volume !== undefined ? okSound.volume : 90;
                document.getElementById('commandListOkSoundPitch').value = okSound.pitch !== undefined ? okSound.pitch : 100;
                document.getElementById('commandListOkSoundPan').value = okSound.pan !== undefined ? okSound.pan : 0;
            } else {
                document.getElementById('commandListOkSoundName').value = '';
                document.getElementById('commandListOkSoundVolume').value = 90;
                document.getElementById('commandListOkSoundPitch').value = 100;
                document.getElementById('commandListOkSoundPan').value = 0;
            }
            toggleSection('commandListOkSoundEnabled', 'commandListOkSoundContainer');

            document.getElementById('commandListModal').classList.add('active');
        }

        // ã‚³ãƒãƒ³ãƒ‰å‰Šé™¤
        function deleteCommandList(index) {
            if (!confirm('ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                return;
            }

            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const windowData = currentCustomData.WindowList[windowIndex];

            let commandList = windowData.CommandList ? JSON.parse(JSON.stringify(windowData.CommandList)) : [];
            commandList.splice(index, 1);
            windowData.CommandList = commandList;

            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification('ã‚³ãƒãƒ³ãƒ‰ã‚’å‰Šé™¤ã—ã¾ã—ãŸ', 'success');
                setTimeout(() => {
                    currentCustomData = getGameCustomData();
                    selectWindow();
                }, 500);
            }
        }

        // ã‚³ãƒãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        function closeCommandListModal() {
            document.getElementById('commandListModal').classList.remove('active');
            resetCommandListForm();
            currentCommandListIndex = -1;
        }

        // ã‚³ãƒãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ä¿å­˜
        function saveCommandListModal() {
            const text = document.getElementById('commandListText').value.trim();
            if (!text) {
                showNotification('ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }

            const editorContainer = document.getElementById('windowEditorContainer');
            const windowIndex = parseInt(editorContainer.dataset.windowIndex);
            const windowData = currentCustomData.WindowList[windowIndex];

            let commandList = windowData.CommandList ? JSON.parse(JSON.stringify(windowData.CommandList)) : [];

            let okSound = {};
            if (document.getElementById('commandListOkSoundEnabled').checked) {
                const okSoundName = document.getElementById('commandListOkSoundName').value.trim();
                okSound = okSoundName ? {
                    name: okSoundName,
                    volume: parseInt(document.getElementById('commandListOkSoundVolume').value) || 90,
                    pitch: parseInt(document.getElementById('commandListOkSoundPitch').value) || 100,
                    pan: parseInt(document.getElementById('commandListOkSoundPan').value) || 0
                } : {};
            }

            let decisionEvent = undefined;
            if (document.getElementById('commandListDecisionEventEnabled').checked) {
                decisionEvent = {
                    CommandId: parseInt(document.getElementById('commandListDecisionCommandId').value) || 0,
                    FocusWindowId: document.getElementById('commandListDecisionFocusWindowId').value || undefined,
                    FocusWindowIndex: parseInt(document.getElementById('commandListDecisionFocusWindowIndex').value) || -1,
                    SwitchId: parseInt(document.getElementById('commandListDecisionSwitchId').value) || 0,
                    Script: document.getElementById('commandListDecisionScript').value || '',
                    Deselect: document.getElementById('commandListDecisionDeselect').checked
                };
            }

            const newCommand = {
                Text: text,
                HelpText: document.getElementById('commandListHelpText').value || '',
                VisibleSwitchId: parseInt(document.getElementById('commandListVisibleSwitchId').value) || 0,
                VisibleScript: document.getElementById('commandListVisibleScript').value || '',
                EnableSwitchId: parseInt(document.getElementById('commandListEnableSwitchId').value) || 0,
                CancelChoice: document.getElementById('commandListCancelChoice').checked,
                Align: parseInt(document.getElementById('commandListAlign').value) || 0,
                IsEnableScript: document.getElementById('commandListIsEnableScript').value || '',
                DecisionEvent: decisionEvent,
                OkSound: okSound
            };

            if (currentCommandListIndex === -1) {
                // æ–°è¦è¿½åŠ 
                commandList.push(newCommand);
            } else {
                // æ—¢å­˜ç·¨é›†
                commandList[currentCommandListIndex] = newCommand;
            }

            windowData.CommandList = commandList;

            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification('ã‚³ãƒãƒ³ãƒ‰ã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
                closeCommandListModal();
                setTimeout(() => {
                    currentCustomData = getGameCustomData();
                    selectWindow();
                }, 500);
            } else {
                showNotification('ã‚³ãƒãƒ³ãƒ‰ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        // ã‚³ãƒãƒ³ãƒ‰ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
        function resetCommandListForm() {
            document.getElementById('commandListText').value = '';
            document.getElementById('commandListHelpText').value = '';
            document.getElementById('commandListVisibleSwitchId').value = 0;
            document.getElementById('commandListVisibleScript').value = '';
            document.getElementById('commandListEnableSwitchId').value = 0;
            document.getElementById('commandListCancelChoice').checked = false;
            document.getElementById('commandListAlign').value = 0;
            document.getElementById('commandListIsEnableScript').value = '';
            document.getElementById('commandListOkSoundName').value = '';
            document.getElementById('commandListOkSoundVolume').value = 90;
            document.getElementById('commandListOkSoundPitch').value = 100;
            document.getElementById('commandListOkSoundPan').value = 0;
            document.getElementById('commandListOkSoundEnabled').checked = false;
            toggleSection('commandListOkSoundEnabled', 'commandListOkSoundContainer');
            document.getElementById('commandListDecisionCommandId').value = 0;
            document.getElementById('commandListDecisionFocusWindowId').innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';
            updateCommandListDecisionFocusWindowSelector();
            document.getElementById('commandListDecisionFocusWindowIndex').value = -1;
            document.getElementById('commandListDecisionSwitchId').value = 0;
            document.getElementById('commandListDecisionScript').value = '';
            document.getElementById('commandListDecisionDeselect').checked = false;
            document.getElementById('commandListDecisionEventEnabled').checked = false;
            toggleSection('commandListDecisionEventEnabled', 'commandListDecisionEventContainer');
        }

        // ã‚³ãƒãƒ³ãƒ‰ãƒªã‚¹ãƒˆæ±ºå®šã‚¤ãƒ™ãƒ³ãƒˆç”¨ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚»ãƒ¬ã‚¯ã‚¿ã‚’æ›´æ–°
        function updateCommandListDecisionFocusWindowSelector(selectedValue) {
            const select = document.getElementById('commandListDecisionFocusWindowId');
            select.innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';

            if (currentCustomData && currentCustomData.WindowList) {
                currentCustomData.WindowList.forEach((win) => {
                    const option = document.createElement('option');
                    option.value = win.Id;
                    option.textContent = win.Id || '(æœªå‘½å)';
                    select.appendChild(option);
                });
            }
            if (selectedValue) {
                select.value = selectedValue;
            }
        }

        // ç›¸å¯¾åº§æ¨™ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’å‹•çš„ã«æ›´æ–°
        function updateRelativeWindowSelectors(currentIndex) {
            const selectX = document.getElementById('windowRelativeWindowIdX');
            const selectY = document.getElementById('windowRelativeWindowIdY');
            const selectList = document.getElementById('windowListWindowId');

            // æ—¢å­˜ã®é¸æŠå€¤ã‚’ä¿å­˜
            const savedValueX = selectX.value;
            const savedValueY = selectY.value;
            const savedValueList = selectList ? selectList.value : '';

            // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆæœ€åˆã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ®‹ã™ï¼‰
            selectX.innerHTML = '<option value="">-- ãªã— --</option>';
            selectY.innerHTML = '<option value="">-- ãªã— --</option>';
            if (selectList) selectList.innerHTML = '<option value="">(ãªã—)</option>';

            // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚¹ãƒˆã‹ã‚‰ä»–ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿½åŠ 
            if (currentCustomData && currentCustomData.WindowList) {
                currentCustomData.WindowList.forEach((win, index) => {
                    if (index !== currentIndex) {
                        const optionX = document.createElement('option');
                        optionX.value = win.Id;
                        optionX.textContent = win.Id || `Window ${index + 1}`;
                        selectX.appendChild(optionX);

                        const optionY = document.createElement('option');
                        optionY.value = win.Id;
                        optionY.textContent = win.Id || `Window ${index + 1}`;
                        selectY.appendChild(optionY);

                        if (selectList) {
                            const optionList = document.createElement('option');
                            optionList.value = win.Id;
                            optionList.textContent = win.Id || `Window ${index + 1}`;
                            selectList.appendChild(optionList);
                        }
                    }
                });
            }

            // å‰ã®å€¤ã‚’å¾©å…ƒ
            selectX.value = savedValueX;
            selectY.value = savedValueY;
            if (selectList) selectList.value = savedValueList;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆç”¨ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’å‹•çš„ã«æ›´æ–°
        function updateEventFocusWindowSelectors() {
            const selectDecision = document.getElementById('decisionFocusWindowId');
            const selectCancel = document.getElementById('cancelFocusWindowId');
            const selectCursor = document.getElementById('cursorFocusWindowId');

            // æ—¢å­˜ã®é¸æŠå€¤ã‚’ä¿å­˜
            const savedValueDecision = selectDecision.value;
            const savedValueCancel = selectCancel.value;
            const savedValueCursor = selectCursor.value;

            // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆæœ€åˆã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯æ®‹ã™ï¼‰
            selectDecision.innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';
            selectCancel.innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';
            selectCursor.innerHTML = '<option value="">(æŒ‡å®šãªã—)</option>';

            // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚¹ãƒˆã‹ã‚‰å…¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿½åŠ 
            if (currentCustomData && currentCustomData.WindowList) {
                currentCustomData.WindowList.forEach((win) => {
                    const optionDecision = document.createElement('option');
                    optionDecision.value = win.Id;
                    optionDecision.textContent = win.Id || '(æœªå‘½å)';
                    selectDecision.appendChild(optionDecision);

                    const optionCancel = document.createElement('option');
                    optionCancel.value = win.Id;
                    optionCancel.textContent = win.Id || '(æœªå‘½å)';
                    selectCancel.appendChild(optionCancel);

                    const optionCursor = document.createElement('option');
                    optionCursor.value = win.Id;
                    optionCursor.textContent = win.Id || '(æœªå‘½å)';
                    selectCursor.appendChild(optionCursor);
                });
            }

            // å‰ã®å€¤ã‚’å¾©å…ƒ
            selectDecision.value = savedValueDecision;
            selectCancel.value = savedValueCancel;
            selectCursor.value = savedValueCursor;
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®å¤‰æ›´ã‚’ä¿å­˜
        function saveWindowChanges() {
            const editorContainer = document.getElementById('windowEditorContainer');
            const index = parseInt(editorContainer.dataset.windowIndex);

            if (isNaN(index) || !currentCustomData.WindowList[index]) {
                showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', 'error');
                return;
            }

            const window = currentCustomData.WindowList[index];

            const newId = document.getElementById('windowId').value.trim();
            if (!newId) {
                showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è­˜åˆ¥å­ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            if (currentCustomData.WindowList.some((w, i) => i !== index && w.Id === newId)) {
                showNotification('ãã®è­˜åˆ¥å­ã¯æ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™', 'error');
                return;
            }
            window.Id = newId;

            // åº§æ¨™ãƒ»ã‚µã‚¤ã‚º
            window.x = parseInt(document.getElementById('windowX').value) || 0;
            window.y = parseInt(document.getElementById('windowY').value) || 0;
            window.RelativeWindowIdX = document.getElementById('windowRelativeWindowIdX').value || '';
            window.RelativeWindowIdY = document.getElementById('windowRelativeWindowIdY').value || '';
            window.width = parseInt(document.getElementById('windowWidth').value) || 0;
            window.height = parseInt(document.getElementById('windowHeight').value) || 0;
            window.ColumnNumber = parseInt(document.getElementById('windowColumns').value) || 1;
            window.RowNumber = parseInt(document.getElementById('windowRows').value) || 0;
            window.originX = parseInt(document.getElementById('windowOriginX').value) || 0;
            window.Rotation = parseInt(document.getElementById('windowRotation').value) || 0;
            window.ItemHeight = parseInt(document.getElementById('windowItemHeight').value) || 0;

            // è¡¨ç¤ºãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³
            window.FontSize = parseInt(document.getElementById('windowFontSize').value) || 0;
            window.FontFace = document.getElementById('windowFontFace').value || '';
            window.textColor = parseInt(document.getElementById('windowTextColor').value) || 0;
            window.noItemBackground = document.getElementById('windowNoItemBackground').checked;

            // å‹•ä½œãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            let okSound = "";
            if (document.getElementById('windowOkSoundEnabled').checked) {
                const okSoundName = document.getElementById('windowOkSoundName').value.trim();
                okSound = okSoundName ? {
                    name: okSoundName,
                    volume: parseInt(document.getElementById('windowOkSoundVolume').value) || 90,
                    pitch: parseInt(document.getElementById('windowOkSoundPitch').value) || 100,
                    pan: parseInt(document.getElementById('windowOkSoundPan').value) || 0
                } : "";
            }
            window.okSound = okSound;

            window.Cancelable = document.getElementById('windowCancelable').checked;
            window.PopCancel = document.getElementById('windowPopCancel').checked;
            window.ActorChangeable = document.getElementById('windowActorChangeable').checked;
            window.ShowOpenAnimation = document.getElementById('windowShowOpenAnimation').checked;
            window.cursorOverContents = document.getElementById('windowCursorOverContents').checked;
            window.noFrame = document.getElementById('windowNoFrame').checked;
            window.HiddenNoFocus = document.getElementById('windowHiddenNoFocus').checked;
            window.DarkNoFocus = document.getElementById('windowDarkNoFocus').checked;
            window.OverlapOther = document.getElementById('windowOverlapOther').checked;

            // ãƒ‡ãƒ¼ã‚¿ãƒ»å¤‰æ•°
            window.VisibleSwitchId = parseInt(document.getElementById('windowVisibleSwitchId').value) || 0;
            window.RefreshSwitchId = parseInt(document.getElementById('windowRefreshSwitchId').value) || 0;
            window.IndexVariableId = parseInt(document.getElementById('windowIndexVariableId').value) || 0;
            window.RememberIndex = document.getElementById('windowRememberIndex').checked;
            window.ItemVariableId = parseInt(document.getElementById('windowItemVariableId').value) || 0;
            window.cursorAllSwitchId = parseInt(document.getElementById('windowCursorAllSwitchId').value) || 0;
            window.MaskingText = document.getElementById('windowMaskingText').value || '';

            // ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
            window.ListWindowId = document.getElementById('windowListWindowId').value || '';
            window.ListScript = document.getElementById('windowListScript').value || '';
            window.FilterScript = document.getElementById('windowFilterScript').value || '';
            window.MappingScript = document.getElementById('windowMappingScript').value || '';
            window.SortScript = document.getElementById('windowSortScript').value || '';
            window.IsEnableScript = document.getElementById('windowIsEnableScript').value || '';
            window.CommonHelpText = document.getElementById('windowCommonHelpText').value || '';
            window.ItemDrawMultiLineScript = document.getElementById('windowItemDrawMultiLineScript').value || '';
            // CommandListã¨ItemDrawScriptã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã§ç®¡ç†ã•ã‚Œã‚‹ãŸã‚ã€ã“ã“ã§ã¯å‡¦ç†ã—ãªã„

            // ã‚¤ãƒ™ãƒ³ãƒˆ
            window.DecisionEvent = document.getElementById('decisionEventEnabled').checked ? {
                CommandId: parseInt(document.getElementById('decisionCommandId').value) || 0,
                FocusWindowId: document.getElementById('decisionFocusWindowId').value || undefined,
                FocusWindowIndex: parseInt(document.getElementById('decisionFocusWindowIndex').value) || -1,
                SwitchId: parseInt(document.getElementById('decisionSwitchId').value) || 0,
                Script: document.getElementById('decisionScript').value || '',
                Deselect: document.getElementById('decisionDeselect').checked
            } : {};

            window.CancelEvent = document.getElementById('cancelEventEnabled').checked ? {
                CommandId: parseInt(document.getElementById('cancelCommandId').value) || 0,
                FocusWindowId: document.getElementById('cancelFocusWindowId').value || undefined,
                FocusWindowIndex: parseInt(document.getElementById('cancelFocusWindowIndex').value) || -1,
                SwitchId: parseInt(document.getElementById('cancelSwitchId').value) || 0,
                Script: document.getElementById('cancelScript').value || '',
                Deselect: document.getElementById('cancelDeselect').checked
            } : {};

            window.CursorEvent = document.getElementById('cursorEventEnabled').checked ? {
                CommandId: parseInt(document.getElementById('cursorCommandId').value) || 0,
                FocusWindowId: document.getElementById('cursorFocusWindowId').value || undefined,
                FocusWindowIndex: parseInt(document.getElementById('cursorFocusWindowIndex').value) || -1,
                SwitchId: parseInt(document.getElementById('cursorSwitchId').value) || 0,
                Script: document.getElementById('cursorScript').value || '',
                Deselect: document.getElementById('cursorDeselect').checked
            } : {};

            if (notifyGameDataChange({ WindowList: currentCustomData.WindowList })) {
                showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼', 'success');
                setTimeout(() => {
                    currentCustomData = getGameCustomData();
                    selectWindow();
                }, 500);
            } else {
                showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®å¤‰æ›´ã‚’ç ´æ£„
        function discardWindowChanges() {
            selectWindow();
            showNotification('ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ç·¨é›†ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ', 'info');
        }

        // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å¼·åˆ¶çµ‚äº†
        function forceCloseMenu() {
            if (!gameWindow || gameWindow.closed) {
                showNotification('ã‚²ãƒ¼ãƒ æ¥ç¶šã‚¨ãƒ©ãƒ¼', 'error');
                return;
            }
            try {
                if (gameWindow.SceneManager) {
                    if (gameWindow.SceneManager._scene instanceof gameWindow.Scene_CustomMenu) {
                        gameWindow.SceneManager.pop();
                        //    gameWindow.focus();
                        showNotification('ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å¼·åˆ¶çµ‚äº†ã—ã¾ã—ãŸ', 'success');
                    } else {
                        showNotification('ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚·ãƒ¼ãƒ³ãŒå®Ÿè¡Œä¸­ã§ã¯ã‚ã‚Šã¾ã›ã‚“', 'warning');
                    }
                }
            } catch (error) {
                console.error('Error closing menu:', error);
                showNotification('ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¼·åˆ¶çµ‚äº†ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        // å¤‰æ›´ã‚’ä¿å­˜
        function saveChanges() {
            const changedData = getFormData();

            if (currentCustomData && currentCustomData.WindowList) {
                // WindowListã®ãƒ‡ã‚£ãƒ¼ãƒ—ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã—ã¦æ•´å½¢
                // PluginParamã®ãƒ©ãƒƒãƒ‘ãƒ¼ã‚’è§£é™¤ã—ã¦ã€å€¤ãŒå¤‰æ›æ¸ˆã¿ã®ãƒ—ãƒ¬ãƒ¼ãƒ³ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹
                const convertToPlain = (obj) => {
                    if (!obj || typeof obj !== 'object') {
                        return obj;
                    }
                    // é…åˆ—ã®å ´åˆ
                    if (Array.isArray(obj)) {
                        return obj.map(convertToPlain);
                    }
                    // PluginParamã®å ´åˆ (gameWindowå´ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚‚å«ã‚€)
                    if (obj._parameter) {
                        const plain = {};
                        // _parameterã®ã‚­ãƒ¼ã«åŸºã¥ã„ã¦ã€getterçµŒç”±ã§å€¤ã‚’å–å¾—ï¼ˆå‹å¤‰æ›ã•ã›ã‚‹ï¼‰
                        Object.keys(obj._parameter).forEach(key => {
                            try {
                                plain[key] = convertToPlain(obj[key]);
                            } catch (e) {
                                plain[key] = convertToPlain(obj._parameter[key]);
                            }
                        });
                        // ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ç›´æ¥è¿½åŠ ã•ã‚ŒãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚‚å–å¾—
                        Object.keys(obj).forEach(key => {
                            if (key !== '_parameter' && plain[key] === undefined) {
                                plain[key] = convertToPlain(obj[key]);
                            }
                        });
                        return plain;
                    }
                    // é€šå¸¸ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ
                    const plain = {};
                    Object.keys(obj).forEach(key => {
                        plain[key] = convertToPlain(obj[key]);
                    });
                    return plain;
                };

                changedData.WindowList = convertToPlain(currentCustomData.WindowList);
            }
            if (notifyGameDataChange(changedData)) {
                // è¦ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦(ã‚²ãƒ¼ãƒ å´)ã®CustomMenuEditorã§plugins.jsã«ä¿å­˜
                try {
                    if (gameWindow && gameWindow.CustomMenuEditor && gameWindow.CustomMenuEditor.saveToPluginsJs) {
                        // èª­ã¿è¾¼ã¿æ™‚ã«å–å¾—ã—ãŸã‚­ãƒ¼ã‚’ä½¿ã£ã¦ä¿å­˜
                        if (gameWindow.CustomMenuEditor.saveToPluginsJs(changedData, currentSceneKey)) {
                            showNotification('å¤‰æ›´ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ãç›´ã—ã¦ãã ã•ã„', 'success');
                        } else {
                            showNotification('ã‚²ãƒ¼ãƒ ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ã•ã‚Œã¾ã—ãŸãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ', 'warning');
                        }
                    } else {
                        showNotification('ã‚²ãƒ¼ãƒ ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ã•ã‚Œã¾ã—ãŸ', 'info');
                    }
                } catch (error) {
                    console.error('Error calling saveToPluginsJs:', error);
                    showNotification('ã‚²ãƒ¼ãƒ ãƒ¡ãƒ¢ãƒªã«ä¿å­˜ã•ã‚Œã¾ã—ãŸ', 'info');
                }

                setTimeout(() => {
                    currentCustomData = getGameCustomData();
                    loadFormData();
                    updateWindowSelector();
                }, 500);
            } else {
                showNotification('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        // plugins.jsãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›´ã‚’ä¿å­˜ï¼ˆè¦ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸãŸã‚å‰Šé™¤ï¼‰

        // å¤‰æ›´ã‚’ç ´æ£„
        function discardChanges() {
            loadFormData();
            showNotification('å¤‰æ›´ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸ', 'info');
        }

        // é€šçŸ¥è¡¨ç¤º
        function showNotification(message, type = 'info') {
            const notify = document.getElementById('notification');
            notify.textContent = message;
            notify.className = 'notification show';
            notify.style.background = type === 'success' ? '#4ec9b0' : type === 'error' ? '#c44e4e' : '#4a9cff';
            setTimeout(() => {
                notify.classList.remove('show');
            }, 4000);
        }

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹
        window.addEventListener('load', () => {
            // ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚»ãƒ¬ã‚¯ãƒˆãƒœãƒƒã‚¯ã‚¹ã‚’åˆæœŸåŒ–
            initializeScriptTemplateSelects();
            const updateInterval = setInterval(() => {
                const data = getGameCustomData();
                if (data && !currentCustomData) {
                    currentCustomData = data;
                    // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿æ™‚ã«ã€ã“ã®ãƒ‡ãƒ¼ã‚¿ãŒã©ã®Sceneã‚­ãƒ¼(Scene1, Scene2...)ã«å¯¾å¿œã™ã‚‹ã‹ã‚’å–å¾—ã—ã¦ä¿æŒã™ã‚‹
                    if (gameWindow && gameWindow.CustomMenuEditor) {
                        currentSceneKey = gameWindow.CustomMenuEditor.findSceneKey(data.Id);
                        console.log('Loaded scene key:', currentSceneKey);
                    }
                    document.getElementById('editorContainer').style.display = 'block';
                    document.getElementById('statusContainer').style.display = 'none';
                    updateWindowSelector();
                    loadFormData();
                } else if (!data && (!gameWindow || gameWindow.closed)) {
                    clearInterval(updateInterval);
                    document.getElementById('statusText').textContent = 'ã‚²ãƒ¼ãƒ æ¥ç¶šãŒå¤±ã‚ã‚Œã¾ã—ãŸ';
                }
            }, 500);
        });


        class PluginParam {

            constructor(parameter, needParse = true) {
                if (needParse) {
                    parameter = JSON.parse(JSON.stringify(parameter, this._paramReplacer));
                }
                this.setup(parameter);
            }

            setup(parameter) {
                this._parameter = parameter;
                for (let paramName in parameter) {
                    if (!parameter.hasOwnProperty(paramName)) {
                        continue;
                    }
                    const subParam = parameter[paramName];
                    if (this._isStructArray(subParam)) {
                        subParam.forEach((subParamItem, index) => {
                            subParam[index] = new PluginParam(subParamItem, false);
                        });
                    } else if (this._isStruct(subParam)) {
                        parameter[paramName] = new PluginParam(subParam, false);
                    }
                    this._createAccessor(paramName);
                }
            }

            _createAccessor(paramName) {
                Object.defineProperty(this, paramName, {
                    get() {
                        return this._convert(this._param(paramName), paramName);
                    },
                    set(value) {
                        this._parameter[paramName] = value;
                    },
                    configurable: true
                });
            }

            _convert(param, paramName) {
                if (this._isStruct(param) || this._isStructArray(param)) {
                    return param;
                } else if (Array.isArray(param)) {
                    return param.map(paramItem => this._convert(paramItem, paramName));
                }
                //           if (!PluginManagerEx.findTextParamSuffixList().some(regExp => paramName.match(regExp))) {
                //              return PluginManagerEx.convertVariables(param);
                //          } else {
                //              return String(param);
                //          }
                return param;
            }

            _isStructArray(param) {
                return Array.isArray(param) && (param.length === 0 || this._isStruct(param[0]));
            }

            _isStruct(param) {
                return Object.prototype.toString.call(param) === '[object Object]';
            }

            _param(name) {
                return this._parameter[name];
            }

            _paramReplacer(key, value) {
                if (value === 'null') {
                    return value;
                }
                if (value[0] === '"' && value[value.length - 1] === '"') {
                    return value;
                }
                try {
                    return JSON.parse(value);
                } catch (e) {
                    return value;
                }
            }
        }


    </script>
</body>

</html>